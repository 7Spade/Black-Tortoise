<div class="user-avatar-container">
    <button 
        class="avatar-button" 
        (click)="facade.toggleAvatarMenu()"
        type="button">
        
        @if (facade.userAvatarVm().photoUrl; as url) {
            <img [src]="url" alt="User avatar" class="avatar-img" />
        } @else {
            <div 
                class="avatar-placeholder" 
                [style.background-color]="facade.userAvatarVm().color"
                aria-hidden="true">
            <span class="initials">{{ facade.userAvatarVm().initials }}</span>
            </div>
        }
    </button>

    @if (facade.showAvatarMenu()) {
        <div class="avatar-menu-overlay" (click)="facade.closeAvatarMenu()"></div>
        <div class="avatar-menu">
            <div class="menu-header">
                <span class="initials-small" [style.background-color]="facade.userAvatarVm().color">
                    {{ facade.userAvatarVm().initials }}
                </span>
                <span class="display-name">{{ facade.identityVm().displayName }}</span>
            </div>
            
            <div class="menu-divider"></div>

            <button class="menu-item" (click)="facade.navigateToProfile()">
                <mat-icon>person</mat-icon>
                <span>Profile</span>
            </button>

            <button class="menu-item" (click)="facade.navigateToSettings()">
                <mat-icon>settings</mat-icon>
                <span>Settings</span>
            </button>

            <div class="menu-divider"></div>

            <button class="menu-item logout" (click)="facade.signOut()">
                <mat-icon>logout</mat-icon>
                <span>Sign Out</span>
            </button>
        </div>
    }
</div>
