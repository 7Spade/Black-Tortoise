# å¤šèº«ä»½å·¥ä½œå€ç³»çµ±å®Œæ•´è¨­è¨ˆè¦æ ¼

> **ç‰ˆæœ¬**: 1.1  
> **æœ€å¾Œæ›´æ–°**: 2026-01-19  
> **é©ç”¨æŠ€è¡“æ£§**: Angular 20 + Firebase + Material Design 3

### Copilot Guardrails (é˜²èª¤è§£è¦ç¯„)
- **æœ¬æ–‡ä»¶æ˜¯å”¯ä¸€æ¬Šå¨è¦æ ¼**ï¼Œä¸å¾—ä»¥ã€Œæ–¹ä¾¿ã€æˆ–ã€Œç›¸å®¹ã€ç‚ºç†ç”±æ–°å¢æ³›ç”¨ã€æ¨¡ç¨œå…©å¯æˆ–é‡è¤‡çš„æ–‡ä»¶ã€‚
- **ä¸å¾—å»ºç«‹ç„¡èªæ„çš„ç¯„æœ¬æˆ–é›œé …æª”æ¡ˆ**ï¼ˆgeneric junk filesï¼‰ã€‚
- æ‰€æœ‰æ–°å¢è¦æ ¼å¿…é ˆæ˜ç¢ºå°æ‡‰ **DDD Boundaries**ï¼Œé¿å…æ“´æ•£æˆ–æ··ç”¨æ¦‚å¿µã€‚
- ä»»ä½•æ–°å¢é¡å‹æˆ–å¯¦é«”å¿…é ˆ **å¯è¿½æº¯åˆ° Domain Context**ï¼Œä¸å¾—è‡¨æ™‚é€ å‹åˆ¥ã€‚

### å‰ç½®æ¢ä»¶ (Domain Artifact å¿…å‚™)
åœ¨å¯¦ä½œæœ¬è¦æ ¼å‰ï¼Œå¿…é ˆå…ˆå­˜åœ¨ä»¥ä¸‹ Domain Artifactï¼Œä¸”ä¸å¾—ä»¥ UI/DTO å–ä»£ï¼š
- **Value Objects**: `IdentityId`, `Email`, `WorkspaceId`, `WorkspaceOwner`, `WorkspaceQuota`, `MembershipId`, `ModuleId`
  - `src/app/domain/identity/value-objects/identity-id.value-object.ts`
  - `src/app/domain/shared/value-objects/email.value-object.ts`
  - `src/app/domain/workspace/value-objects/workspace-id.value-object.ts`
  - `src/app/domain/workspace/value-objects/workspace-owner.value-object.ts`
  - `src/app/domain/workspace/value-objects/workspace-quota.value-object.ts`
  - `src/app/domain/membership/value-objects/membership-id.value-object.ts`
  - `src/app/domain/modules/value-objects/module-id.value-object.ts`
- **Entities**: `User`, `Organization`, `Bot`, `Team`, `Partner`, `Workspace`, `WorkspaceModule`
  - `src/app/domain/identity/entities/`
  - `src/app/domain/membership/entities/`
  - `src/app/domain/workspace/entities/`
  - `src/app/domain/modules/entities/`
- **Aggregate Root**: `WorkspaceAggregate`
  - `src/app/domain/workspace/aggregates/workspace.aggregate.ts`

---

## ğŸ“‹ ç›®éŒ„

1. [æ ¸å¿ƒæ¦‚å¿µæ¶æ§‹](#1-æ ¸å¿ƒæ¦‚å¿µæ¶æ§‹)
2. [èº«ä»½å±¤ç´šè¨­è¨ˆ](#2-èº«ä»½å±¤ç´šè¨­è¨ˆ)
3. [å·¥ä½œå€èˆ‡æ¨¡çµ„é—œä¿‚](#3-å·¥ä½œå€èˆ‡æ¨¡çµ„é—œä¿‚)
4. [çµ„ç¹”ç®¡ç†é«”ç³»](#4-çµ„ç¹”ç®¡ç†é«”ç³»)
5. [åˆ‡æ›å™¨ç³»çµ±è¨­è¨ˆ](#5-åˆ‡æ›å™¨ç³»çµ±è¨­è¨ˆ)
6. [å…¨å±€å¸ƒå±€æ¶æ§‹](#6-å…¨å±€å¸ƒå±€æ¶æ§‹)
7. [æ¬Šé™èˆ‡å­˜å–æ§åˆ¶](#7-æ¬Šé™èˆ‡å­˜å–æ§åˆ¶)
8. [ä½¿ç”¨è€…é«”é©—æµç¨‹](#8-ä½¿ç”¨è€…é«”é©—æµç¨‹)
9. [è³‡æ–™æ¨¡å‹é—œä¿‚](#9-è³‡æ–™æ¨¡å‹é—œä¿‚)

---

## 1. æ ¸å¿ƒæ¦‚å¿µæ¶æ§‹

### 1.1 ç³»çµ±å±¤ç´šçµæ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Global Shell                         â”‚
â”‚                   (å…¨å±€å¤–æ®¼)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Identity Layer (èº«ä»½å±¤)                                 â”‚
â”‚  â”œâ”€ User (å€‹äººç”¨æˆ¶)                                      â”‚
â”‚  â”œâ”€ Organization (çµ„ç¹”)                                  â”‚
â”‚  â””â”€ Bot (æœå‹™å¸³è™Ÿ)                                       â”‚
â”‚                                                         â”‚
â”‚  â†“                                                      â”‚
â”‚                                                         â”‚
â”‚  Membership Layer (æˆå“¡é—œä¿‚)                             â”‚
â”‚  â”œâ”€ Team (çµ„ç¹”å…§éƒ¨åˆ†çµ„)                                  â”‚
â”‚  â””â”€ Partner (å¤–éƒ¨å”ä½œåˆ†çµ„)                               â”‚
â”‚                                                         â”‚
â”‚  â†“                                                      â”‚
â”‚                                                         â”‚
â”‚  Workspace Layer (å·¥ä½œå€å±¤)                              â”‚
â”‚  â”œâ”€ ownerId: User | Organization                        â”‚
â”‚  â”œâ”€ ownerType: 'user' | 'organization'                  â”‚
â”‚  â””â”€ moduleIds: ModuleId[]                               â”‚
â”‚                                                         â”‚
â”‚  â†“                                                      â”‚
â”‚                                                         â”‚
â”‚  Module Layer (æ¨¡çµ„å±¤)                                   â”‚
â”‚  â”œâ”€ Overview (ç¸½è¦½)                                      â”‚
â”‚  â”œâ”€ Documents (æ–‡ä»¶ç®¡ç†)                                 â”‚
â”‚  â”œâ”€ Tasks (ä»»å‹™ç®¡ç†)                                     â”‚
â”‚  â”œâ”€ Settings (å·¥ä½œå€è¨­å®š)                                â”‚
â”‚  â””â”€ Calendar (è¡Œäº‹æ›†)                                    â”‚
â”‚                                                         â”‚
â”‚  â†“                                                      â”‚
â”‚                                                         â”‚
â”‚  Entity Layer (å¯¦é«”å±¤)                                   â”‚
â”‚  â””â”€ å…·é«”æ¥­å‹™å¯¦é«” (æ–‡ä»¶ã€ä»»å‹™ã€è©•è«–ç­‰)                     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 é—œéµè¨­è¨ˆåŸå‰‡

#### èº«ä»½ç¨ç«‹æ€§
- **User / Organization / Bot** æ˜¯å¯ç™»å…¥çš„èº«ä»½å¯¦é«” (Identity Layer)
- **Team / Partner** å±¬æ–¼ Membership Layer çš„æˆå“¡åˆ†çµ„,ä¸æ˜¯å¯ç™»å…¥èº«ä»½
- èº«ä»½ä¹‹é–“ä¸å­˜åœ¨åµŒå¥—é—œä¿‚,åƒ…å­˜åœ¨æˆå“¡é—œä¿‚

#### æ“æœ‰æ¬Šæ˜ç¢ºæ€§
- **Workspace åªèƒ½ç”± User æˆ– Organization æ“æœ‰**
- Team / Partner ä¸èƒ½ç›´æ¥æ“æœ‰ Workspace
- ä½¿ç”¨ `WorkspaceOwner` Value Object å°è£ `ownerId` + `ownerType`

#### æˆå“¡é—œä¿‚ç®¡ç†
- Organization / Team / Partner é€é `memberIds` é—œè¯æˆå“¡
- ä¸åœ¨å¯¦é«”ä¸­åµŒå¥—å®Œæ•´ User ç‰©ä»¶,åƒ…å„²å­˜ ID å¼•ç”¨
- æˆå“¡è³‡æ–™é€é Repository æŸ¥è©¢å–å¾—

#### è³‡æ–™ä¸é‡è¤‡
- Workspace ä¸å„²å­˜æˆå“¡åˆ—è¡¨,åƒ…å­˜ ownerId
- æˆå“¡ç®¡ç†é€é Team / Partner / Organization é€²è¡Œ
- é¿å…è³‡æ–™å†—é¤˜å’Œä¸ä¸€è‡´

---

## 2. èº«ä»½å±¤ç´šè¨­è¨ˆ

### 2.1 èº«ä»½é¡å‹å®šç¾©

**å¯ç™»å…¥å’Œåˆ‡æ›çš„å¸³è™Ÿé¡å‹ (Identity Types):**

```typescript
type IdentityType = 'user' | 'organization' | 'bot';
```

**æˆå“¡é—œä¿‚é¡å‹ (Membership Types):**

```typescript
type MembershipType = 'team' | 'partner';
```

**å­˜å–ä¸»é«”é¡å‹ (Access Subject Types):**

```typescript
type AccessSubjectType = 'user' | 'organization' | 'team' | 'partner';
```

**é‡è¦èªªæ˜:**
- **åªæœ‰ä»¥ä¸Šä¸‰ç¨®æ˜¯å¯ç™»å…¥èº«ä»½ (Identity)**ï¼šUser / Organization / Bot
- **Team / Partner ä¸æ˜¯ç¨ç«‹ç™»å…¥èº«ä»½**ï¼Œåƒ…æ˜¯ Organization ä¸‹çš„æˆå“¡åˆ†çµ„è¦–è§’
- Identity Switcher (Account Switcher) å…è¨±åœ¨ Organization ä¸‹åˆ‡æ› Team / Partner çš„ **ä¸Šä¸‹æ–‡ç¯„åœ**

### 2.2 User (å€‹äººç”¨æˆ¶)

**å®šç¾©**:
- ç³»çµ±ä¸­çš„è‡ªç„¶äººå¸³è™Ÿ
- å¯ä»¥ç¨ç«‹å‰µå»ºå’Œæ“æœ‰ Workspace
- å¯ä»¥åŠ å…¥ Organization æˆç‚ºçµ„ç¹”æˆå“¡
- å¯ä»¥è¢«åŠ å…¥ Organization å…§éƒ¨çš„ Team
- å¯ä»¥ä½œç‚º Partner çš„å¤–éƒ¨å”ä½œè€…

**å±¬æ€§**:
```typescript
interface User {
  id: IdentityId;                // å”¯ä¸€è­˜åˆ¥ç¢¼ (Value Object)
  organizationIds: string[];     // æ‰€å±¬çµ„ç¹” ID åˆ—è¡¨
  teamIds: string[];             // æ‰€å±¬åœ˜éšŠ ID åˆ—è¡¨
  partnerIds: string[];          // æ‰€å±¬å¤¥ä¼´ ID åˆ—è¡¨
  workspaceIds: string[];        // å¯å­˜å–çš„å·¥ä½œå€ ID
}
```

**ä½¿ç”¨å ´æ™¯**:
- å€‹äººå°ˆæ¡ˆç®¡ç† (æ“æœ‰å€‹äºº Workspace)
- ä½œç‚ºçµ„ç¹”æˆå“¡åƒèˆ‡çµ„ç¹”å·¥ä½œ
- åœ¨çµ„ç¹”å…§çš„ Team ä¸­å”ä½œ
- ä½œç‚ºå¤–éƒ¨ Partner å”ä½œè€…å­˜å–æˆæ¬Šè³‡æº

### 2.3 Organization (çµ„ç¹”)

**å®šç¾©**:
- å…¬å¸ã€ä¼æ¥­ã€åœ˜é«”ç­‰çµ„ç¹”å¯¦é«”
- å¯ä»¥å‰µå»ºå’Œæ“æœ‰ Workspace
- å¯ä»¥ç®¡ç†å…§éƒ¨ Team (å¾çµ„ç¹”æˆå“¡ä¸­åˆ†çµ„)
- å¯ä»¥ç®¡ç†å¤–éƒ¨ Partner (å¤–éƒ¨å”ä½œè€…)
- æ“æœ‰çµ„ç¹”å±¤ç´šçš„è¨­å®šå’Œæ¬Šé™é«”ç³»

**å±¬æ€§**:
```typescript
interface Organization {
  id: IdentityId;                  // å”¯ä¸€è­˜åˆ¥ç¢¼ (Value Object)
  memberIds: string[];             // çµ„ç¹”çš„æ­£å¼æˆå“¡
  teamIds: string[];               // Team.id åˆ—è¡¨
  partnerIds: string[];            // Partner.id åˆ—è¡¨
  workspaceIds: string[];          // å¯å­˜å–çš„å·¥ä½œå€ ID
}
```

**çµ„ç¹”è§’è‰²**:
- **Owner** (æ“æœ‰è€…) - æœ€é«˜æ¬Šé™,å”¯ä¸€
- **Admin** (ç®¡ç†å“¡) - ç®¡ç†çµ„ç¹”å’Œæˆå“¡
- **Member** (æˆå“¡) - ä¸€èˆ¬æˆå“¡

**ä½¿ç”¨å ´æ™¯**:
- ä¼æ¥­å·¥ä½œå€ç®¡ç†
- éƒ¨é–€å”ä½œ
- è·¨åœ˜éšŠå°ˆæ¡ˆ
- å®¢æˆ¶åˆä½œç®¡ç†

**é‡è¦è¦å‰‡**:
- Organization æˆå“¡å¿…é ˆå…ˆè¢«é‚€è«‹åŠ å…¥ (åŠ å…¥ memberIds)
- Team åªèƒ½å¾ç¾æœ‰çš„ Organization æˆå“¡ä¸­é¸æ“‡çµ„æˆ
- Partner æ˜¯å¤–éƒ¨å”ä½œè€…,ä¸åœ¨ memberIds ä¸­

### 2.4 Team (åœ˜éšŠ) - çµ„ç¹”å…§éƒ¨åˆ†çµ„

**å®šç¾©**:
- **Team ä¸æ˜¯ç¨ç«‹å¸³è™Ÿ,ä¸èƒ½ç™»å…¥ç³»çµ±**
- æ˜¯ Organization å…§éƒ¨çš„æˆå“¡åˆ†çµ„æ©Ÿåˆ¶
- ç”¨æ–¼çµ„ç¹”å…§éƒ¨çš„éƒ¨é–€ã€å°çµ„ã€å°ˆæ¡ˆåœ˜éšŠç®¡ç†
- Team æˆå“¡**å¿…é ˆæ˜¯è©² Organization çš„æˆå“¡** (åœ¨ Organization.memberIds ä¸­)
- **ä¸èƒ½ç¨ç«‹æ“æœ‰ Workspace**
- **ä¸æœƒå‡ºç¾åœ¨èº«ä»½åˆ‡æ›å™¨çš„ä¸»åˆ—è¡¨ä¸­**
- åƒ…åœ¨å°æ‡‰ Organization èº«ä»½ä¸‹çš„ Team å€å¡Šä¸­é¡¯ç¤º,å¯åˆ‡æ›ä¸Šä¸‹æ–‡

**å±¬æ€§**:
```typescript
interface Team {
  id: MembershipId;                // å”¯ä¸€è­˜åˆ¥ç¢¼ (Value Object)
  organizationId: string;          // æ‰€å±¬çµ„ç¹” ID
  memberIds: string[];             // User.id[]
}
```

**åœ˜éšŠè§’è‰²**:
- **Team Lead** (è² è²¬äºº) - ç®¡ç†åœ˜éšŠ
- **Member** (æˆå“¡) - åœ˜éšŠæˆå“¡

**ä½¿ç”¨å ´æ™¯**:
- éƒ¨é–€å·¥ä½œç®¡ç† (å¦‚å·¥ç¨‹éƒ¨ã€è¡ŒéŠ·éƒ¨)
- å°ˆæ¡ˆå°çµ„ (å¦‚ç”¢å“é–‹ç™¼åœ˜éšŠ)
- åŠŸèƒ½åœ˜éšŠ (å¦‚è¨­è¨ˆåœ˜éšŠã€QA åœ˜éšŠ)

**å‰µå»ºæµç¨‹**:
1. åˆ‡æ›åˆ° Organization èº«ä»½
2. åœ¨èº«ä»½åˆ‡æ›å™¨ä¸­é»æ“Šã€Œå»ºç«‹æ–°åœ˜éšŠã€æˆ–é€²å…¥åœ˜éšŠç®¡ç†é é¢
3. å¡«å¯«åœ˜éšŠè³‡è¨Š
4. **åªèƒ½å¾è©² Organization çš„ç¾æœ‰æˆå“¡ (memberIds) ä¸­é¸æ“‡åœ˜éšŠæˆå“¡**
5. æŒ‡å®šåœ˜éšŠè² è²¬äºº

**å­˜å–æ§åˆ¶**:
- Team å¯ä»¥è¢«æŒ‡æ´¾åˆ° Organization æ“æœ‰çš„ Workspace
- Team æˆå“¡è‡ªå‹•ç²å¾—è©² Workspace çš„å°æ‡‰æ¬Šé™
- Team æˆå“¡åœ¨ Organization èº«ä»½ä¸‹å·¥ä½œæ™‚,å¯å­˜å–è¢«æŒ‡æ´¾çš„ Workspace

**é™åˆ¶**:
- âŒ Team ä¸èƒ½ç›´æ¥å‰µå»º Workspace
- âŒ Team ä¸èƒ½æ“æœ‰ Workspace
- âœ… Team ä¸æ˜¯ç™»å…¥èº«ä»½ï¼Œä½†å¯åœ¨ Identity Switcher ä¸­åˆ‡æ› **Team ä¸Šä¸‹æ–‡**

### 2.5 Partner (å¤¥ä¼´) - å¤–éƒ¨å”ä½œè€…åˆ†çµ„

**å®šç¾©**:
- **Partner ä¸æ˜¯ç¨ç«‹å¸³è™Ÿ,ä¸èƒ½ç™»å…¥ç‚º Partner èº«ä»½**
- æ˜¯ Organization å¤–éƒ¨å”ä½œè€…çš„ç®¡ç†æ©Ÿåˆ¶
- Partner æˆå“¡æ˜¯**å¤–éƒ¨çš„ User**,**ä¸åœ¨ Organization.memberIds ä¸­**
- å¿…é ˆé€é Organization é‚€è«‹å»ºç«‹é—œä¿‚
- å¯ä»¥æ˜¯å€‹äººè‡ªç”±å·¥ä½œè€…æˆ–å¤–éƒ¨å…¬å¸çš„ä»£è¡¨
- **ä¸èƒ½ç¨ç«‹æ“æœ‰ Workspace**
- **ä¸æœƒå‡ºç¾åœ¨èº«ä»½åˆ‡æ›å™¨çš„ä¸»åˆ—è¡¨ä¸­**
- åƒ…åœ¨å°æ‡‰ Organization èº«ä»½ä¸‹çš„ Partner å€å¡Šä¸­é¡¯ç¤º,å¯åˆ‡æ›ä¸Šä¸‹æ–‡

**å±¬æ€§**:
```typescript
interface Partner {
  id: MembershipId;                // å”¯ä¸€è­˜åˆ¥ç¢¼ (Value Object)
  organizationId: string;          // é—œè¯çš„ Organization ID
  memberIds: string[];             // å¤–éƒ¨æˆå“¡åˆ—è¡¨
}
```

**å­˜å–ç­‰ç´š**:
- **Limited** (å—é™): æœ€å°æ¬Šé™,åƒ…èƒ½æŸ¥çœ‹æŒ‡å®šå…§å®¹
- **Standard** (æ¨™æº–): å¯æŸ¥çœ‹å’Œç·¨è¼¯æˆæ¬Šçš„æ¨¡çµ„
- **Full** (å®Œæ•´): æ¥è¿‘çµ„ç¹”æˆå“¡çš„æ¬Šé™ (ä½†ä»å—é™æ–¼æˆæ¬Šç¯„åœ)

**å¤¥ä¼´è§’è‰²**:
- **Partner Admin** (å¤¥ä¼´ç®¡ç†å“¡) - ç®¡ç†è©² Partner çš„æˆå“¡å’Œè¨­å®š
- **Collaborator** (å”ä½œè€…) - å¤¥ä¼´æ–¹çš„ä¸€èˆ¬æˆå“¡

**ä½¿ç”¨å ´æ™¯**:
- å¤–éƒ¨é¡§å•å”ä½œ
- ä¾›æ‡‰å•†å°æ¥
- å®¢æˆ¶å”åŒå·¥ä½œ
- å¤–åŒ…åœ˜éšŠç®¡ç†
- è‡¨æ™‚å°ˆæ¡ˆåˆä½œ

**å‰µå»ºæµç¨‹**:
1. åˆ‡æ›åˆ° Organization èº«ä»½
2. åœ¨èº«ä»½åˆ‡æ›å™¨ä¸­é»æ“Šã€Œæ–°å¢å¤¥ä¼´ã€æˆ–é€²å…¥å¤¥ä¼´ç®¡ç†é é¢
3. å¡«å¯«å¤¥ä¼´è³‡è¨Š (åç¨±ã€è¯çµ¡æ–¹å¼ã€å­˜å–ç­‰ç´š)
4. **é‚€è«‹å¤–éƒ¨ User åŠ å…¥è©² Partner** (é€éé›»å­éƒµä»¶)
5. å¤–éƒ¨ User æ¥å—é‚€è«‹å¾Œæˆç‚º Partner æˆå“¡
6. è¨­å®šè©² Partner å¯å­˜å–çš„ Workspace å’Œæ¨¡çµ„

**å­˜å–æ§åˆ¶**:
- Partner åªèƒ½å­˜å–è¢«æ˜ç¢ºæˆæ¬Šçš„ Organization Workspace
- å­˜å–æ¬Šé™ç”± Organization å®Œå…¨æ§åˆ¶
- å¯ä»¥è¨­å®šå…è¨±çš„æ¨¡çµ„å’Œæ“ä½œé™åˆ¶
- å¯ä»¥è¨­å®šå­˜å–æœŸé™

**èˆ‡ Organization Member çš„é—œéµå·®ç•°**:
- âŒ Partner æˆå“¡**ä¸æ˜¯** Organization çš„æ­£å¼æˆå“¡
- âŒ Partner æˆå“¡**ä¸åœ¨** Organization.memberIds ä¸­
- âŒ Partner æˆå“¡**ä¸èƒ½**è¢«åŠ å…¥ Team
- âŒ Partner **ä¸èƒ½**å‰µå»ºæˆ–æ“æœ‰ Workspace
- âœ… Partner æˆå“¡ä»¥è‡ªå·±çš„ User èº«ä»½ç™»å…¥,å­˜å–è¢«æˆæ¬Šçš„è³‡æº
- âœ… Partner æˆå“¡åœ¨å­˜å– Organization è³‡æºæ™‚æœƒçœ‹åˆ°ã€ŒPartner Accessã€æ¨™è¨»

**é™åˆ¶**:
- âŒ Partner ä¸èƒ½å‰µå»º Workspace
- âœ… Partner ä¸æ˜¯ç™»å…¥èº«ä»½ï¼Œä½†å¯åœ¨ Identity Switcher ä¸­åˆ‡æ› **Partner ä¸Šä¸‹æ–‡**
- âŒ Partner æˆå“¡ä¸èƒ½é‚€è«‹å…¶ä»–äººåŠ å…¥ Organization

### 2.6 Bot (æœå‹™å¸³è™Ÿ)

**å®šç¾©**:
- è‡ªå‹•åŒ–æœå‹™æˆ– API æ•´åˆä½¿ç”¨çš„å¸³è™Ÿ
- ç”¨æ–¼ç³»çµ±é–“äº’å‹•
- ç„¡æ³•ç™»å…¥ UI ä»‹é¢

**å±¬æ€§**:
- `id`: IdentityId - å”¯ä¸€è­˜åˆ¥ç¢¼ (Value Object)

**ä½¿ç”¨å ´æ™¯**:
- CI/CD æ•´åˆ
- ç¬¬ä¸‰æ–¹æœå‹™å°æ¥
- è‡ªå‹•åŒ–å·¥ä½œæµç¨‹

---

## 3. å·¥ä½œå€èˆ‡æ¨¡çµ„é—œä¿‚

### 3.1 Workspace (å·¥ä½œå€)

**å®šç¾©**:
- é‚è¼¯å®¹å™¨,ç”¨æ–¼çµ„ç¹”ç›¸é—œå·¥ä½œå…§å®¹
- åŒ…å«å¤šå€‹åŠŸèƒ½æ¨¡çµ„
- æ˜ç¢ºçš„æ“æœ‰è€…å’Œå­˜å–æ§åˆ¶
- **åªæœ‰ User / Organization å¯æ“æœ‰ Workspace**ï¼Œæ¯å€‹æ“æœ‰è€…å¯æŒæœ‰å¤šå€‹ Workspace
- **Workspace èˆ‡ Owner çš„é—œè¯å¿…é ˆåš´æ ¼ç¶­æŒ**ï¼Œä¸å¾—æ–°å¢å…¶ä»–æ“æœ‰è€…é¡å‹

**æ ¸å¿ƒå±¬æ€§**:
```typescript
interface Workspace {
  id: WorkspaceId;                         // å”¯ä¸€è­˜åˆ¥ç¢¼ (Value Object)
  owner: WorkspaceOwner;                   // æ“æœ‰è€… Value Object
  moduleIds: string[];                     // æ¨¡çµ„ ID åˆ—è¡¨
}
```

**å·¥ä½œå€é¡å‹**:
- ç›®å‰åªæœ‰ **Project** ä¸€ç¨®å·¥ä½œå€é¡å‹ (MVP éšæ®µ)ã€‚
- **ç¦æ­¢æ–°å¢ workspaceType æ¬„ä½**ï¼Œå¦‚éœ€æ“´å±•ï¼Œå¿…é ˆå…ˆå®Œæˆ Domain æ“´å……èˆ‡è¦æ ¼æ›´æ–°ã€‚

**ç”Ÿå‘½å‘¨æœŸèˆ‡é…é¡**:
- Workspace çš„ç”Ÿå‘½é€±æœŸã€é…é¡èˆ‡æ“æœ‰æ¬Šè³‡è¨Šç”± `WorkspaceAggregate` å°è£ã€‚
- ä¸å¯åœ¨ UI/Infrastructure å±¤ç›´æ¥æ–°å¢æˆ–ä¿®æ”¹é€™äº›æ¬„ä½ã€‚

**é—œéµè¦å‰‡**:
1. **æ“æœ‰è€…é™åˆ¶**: åªèƒ½æ˜¯ User æˆ– Organization
2. **Team ä½¿ç”¨æ–¹å¼**: Team æˆå“¡åœ¨ Organization çš„ Workspace ä¸­å”ä½œ,ä½† Team æœ¬èº«ä¸æ“æœ‰ Workspace
3. **Partner ä½¿ç”¨æ–¹å¼**: Partner åƒ…èƒ½å­˜å–è¢«æˆæ¬Šçš„ Organization Workspace
4. **æˆå“¡ç®¡ç†**: é€é Permission ç³»çµ±å’Œ ACL ç®¡ç†,ä¸åœ¨ Workspace ä¸­ç›´æ¥å„²å­˜æˆå“¡åˆ—è¡¨

### 3.2 Module (æ¨¡çµ„)

**å®šç¾©**:
- Workspace å…§çš„åŠŸèƒ½å–®å…ƒ
- æ¯å€‹æ¨¡çµ„æä¾›ç‰¹å®šæ¥­å‹™åŠŸèƒ½
- å¯ç¨ç«‹å•Ÿç”¨/åœç”¨

**æ¨™æº–æ¨¡çµ„åˆ—è¡¨** (å°æ‡‰ `ModuleType`):

| æ¨¡çµ„ | è­˜åˆ¥ç¢¼ | æè¿° | é è¨­å•Ÿç”¨ |
|------|--------|------|----------|
| Overview | `overview` | ç¸½è¦½å„€è¡¨æ¿ | âœ“ |
| Documents | `documents` | æ–‡ä»¶èˆ‡è³‡æ–™å¤¾ç®¡ç† | âœ“ |
| Tasks | `tasks` | ä»»å‹™èˆ‡å¾…è¾¦äº‹é … | âœ“ |
| Calendar | `calendar` | è¡Œäº‹æ›† | âœ“ |
| Settings | `settings` | å·¥ä½œå€è¨­å®š | âœ“ |

**æ¨¡çµ„æ¬Šé™**:
```typescript
interface ModulePermission {
  moduleId: string;
  accountId: string;              // User/Team/Partner ID
  accountType: AccessSubjectType;
  role: 'viewer' | 'editor' | 'admin';
  grantedAt: Timestamp;
}
```

---

## 4. çµ„ç¹”ç®¡ç†é«”ç³»

### 4.1 çµ„ç¹”å‰µå»ºæµç¨‹

**æ­¥é©Ÿ**:
1. User é€éã€Œèº«ä»½åˆ‡æ›å™¨ã€é¸æ“‡ã€Œå»ºç«‹æ–°çµ„ç¹”ã€
2. å¡«å¯«çµ„ç¹”åŸºæœ¬è³‡è¨Š (åç¨±)
3. è¨­å®šçµ„ç¹”é¡å‹å’Œåˆå§‹è¨­å®š
4. ç³»çµ±å‰µå»º Organization å¯¦é«”
5. å‰µå»ºè€…è‡ªå‹•æˆç‚º Organization Owner
6. å¯é¸æ“‡ç«‹å³å‰µå»ºç¬¬ä¸€å€‹ Workspace

**UI æµç¨‹**:
```
èº«ä»½åˆ‡æ›å™¨
  â†“ é»æ“Šã€Œå»ºç«‹çµ„ç¹”ã€
å»ºç«‹çµ„ç¹”å°è©±æ¡† (Dialog)
  â”œâ”€ çµ„ç¹”åç¨± (å¿…å¡«)
  â”œâ”€ è¦–è¦ºè³‡è¨Š (å¯é¸, Presentation å±¤)
  â””â”€ çµ„ç¹”æè¿° (å¯é¸)
  â†“ ç¢ºèª
çµ„ç¹”å‰µå»ºæˆåŠŸ
  â†“ è‡ªå‹•åˆ‡æ›èº«ä»½
çµ„ç¹”é¦–é 
  â””â”€ å¼•å°å‰µå»ºç¬¬ä¸€å€‹ Workspace
```

### 4.2 æˆå“¡é‚€è«‹èˆ‡ç®¡ç†

**é‚€è«‹æˆå“¡è‡³çµ„ç¹”**:
1. åœ¨ Organization èº«ä»½ä¸‹,é€²å…¥ã€Œæˆå“¡ç®¡ç†ã€
2. é»æ“Šã€Œé‚€è«‹æˆå“¡ã€
3. è¼¸å…¥é›»å­éƒµä»¶,é¸æ“‡è§’è‰² (Admin/Member)
4. ç³»çµ±ç™¼é€é‚€è«‹éƒµä»¶
5. å—é‚€è€…æ¥å—å¾Œè‡ªå‹•åŠ å…¥çµ„ç¹”

**æˆå“¡åˆ—è¡¨é¡¯ç¤º**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ çµ„ç¹”æˆå“¡ (Organization Members)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ‘¤] John Doe                        Owner  [â‹®] â”‚
â”‚      john@company.com                            â”‚
â”‚                                                  â”‚
â”‚ [ğŸ‘¤] Jane Smith                      Admin  [â‹®] â”‚
â”‚      jane@company.com                            â”‚
â”‚      Teams: Engineering, Design                  â”‚
â”‚                                                  â”‚
â”‚ [ğŸ‘¤] Mike Johnson                    Member [â‹®] â”‚
â”‚      mike@company.com                            â”‚
â”‚      Teams: Engineering                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 åœ˜éšŠå‰µå»ºèˆ‡ç®¡ç†

**é‡è¦å‰æ**:
- Team ä¸æ˜¯ç¨ç«‹å¸³è™Ÿ,æ˜¯ Organization å…§éƒ¨çš„æˆå“¡åˆ†çµ„
- Team æˆå“¡**å¿…é ˆå…ˆæ˜¯ Organization çš„æˆå“¡** (åœ¨ Organization.memberIds ä¸­)
- ä¸èƒ½ç›´æ¥é‚€è«‹å¤–éƒ¨äººå“¡åŠ å…¥ Team

**åœ¨çµ„ç¹”å…§å‰µå»ºåœ˜éšŠçš„æ–¹å¼**:

#### æ–¹å¼ 1: é€éèº«ä»½åˆ‡æ›å™¨
```
1. åˆ‡æ›è‡³ Organization èº«ä»½
   â†“
2. é»æ“Šèº«ä»½åˆ‡æ›å™¨
   â†“ å±•é–‹é¸å–®
3. åœ¨ã€Œåœ˜éšŠã€å€å¡Šä¸­é»æ“Šã€Œå»ºç«‹æ–°åœ˜éšŠã€
   â†“
4. é–‹å•Ÿå»ºç«‹åœ˜éšŠå°è©±æ¡†
   â”œâ”€ åœ˜éšŠåç¨± (å¿…å¡«)
   â”œâ”€ åœ˜éšŠæè¿° (å¯é¸)
   â”œâ”€ é¸æ“‡åœ˜éšŠè² è²¬äºº (å¾çµ„ç¹”æˆå“¡ä¸­é¸æ“‡)
   â””â”€ é¸æ“‡åœ˜éšŠæˆå“¡ (å¾çµ„ç¹”æˆå“¡ä¸­å¤šé¸)
   â†“
5. ç¢ºèªå‰µå»º
   â†“
6. åœ˜éšŠå‰µå»ºæˆåŠŸ,è‡ªå‹•åŠ å…¥ Organization.teamIds
```

#### æ–¹å¼ 2: é€éçµ„ç¹”è¨­å®šé é¢
```
1. åˆ‡æ›è‡³ Organization èº«ä»½
   â†“
2. é€²å…¥å·¥ä½œå€ â†’ Settings æ¨¡çµ„ â†’ åœ˜éšŠç®¡ç†
   â†“
3. é»æ“Šã€Œå»ºç«‹æ–°åœ˜éšŠã€æŒ‰éˆ•
   â†“
4. (å¾ŒçºŒæµç¨‹åŒæ–¹å¼ 1)
```

**åœ˜éšŠç®¡ç†ä»‹é¢**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åœ˜éšŠç®¡ç† (Teams Management)   [+ å»ºç«‹æ–°åœ˜éšŠ]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å·¥ç¨‹éƒ¨é–€ã€‘                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [ğŸ‘¥] Engineering Team                        â”‚ â”‚
â”‚ â”‚      è² è²¬äºº: John Doe                         â”‚ â”‚
â”‚ â”‚      æˆå“¡: 12 äºº                              â”‚ â”‚
â”‚ â”‚      â€¢ Alice (alice@company.com)             â”‚ â”‚
â”‚ â”‚      â€¢ Bob (bob@company.com)                 â”‚ â”‚
â”‚ â”‚      â€¢ ...                                   â”‚ â”‚
â”‚ â”‚      [ç·¨è¼¯åœ˜éšŠ] [ç®¡ç†æˆå“¡] [åˆªé™¤]    [â‹®]      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â”‚ ã€è¨­è¨ˆéƒ¨é–€ã€‘                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [ğŸ‘¥] Design Team                             â”‚ â”‚
â”‚ â”‚      è² è²¬äºº: Jane Smith                       â”‚ â”‚
â”‚ â”‚      æˆå“¡: 8 äºº                               â”‚ â”‚
â”‚ â”‚      â€¢ Charlie (charlie@company.com)         â”‚ â”‚
â”‚ â”‚      â€¢ Diana (diana@company.com)             â”‚ â”‚
â”‚ â”‚      â€¢ ...                                   â”‚ â”‚
â”‚ â”‚      [ç·¨è¼¯åœ˜éšŠ] [ç®¡ç†æˆå“¡] [åˆªé™¤]    [â‹®]      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åœ˜éšŠæˆå“¡ç®¡ç†**:
```
åœ˜éšŠè©³æƒ…é é¢
â”œâ”€ åŸºæœ¬è³‡è¨Š
â”‚  â”œâ”€ åœ˜éšŠåç¨± (å¯ç·¨è¼¯)
â”‚  â”œâ”€ åœ˜éšŠæè¿° (å¯ç·¨è¼¯)
â”‚  â””â”€ æ‰€å±¬çµ„ç¹” (å”¯è®€)
â”‚
â”œâ”€ æˆå“¡åˆ—è¡¨
â”‚  â”œâ”€ åªèƒ½å¾ Organization.memberIds ä¸­é¸æ“‡
â”‚  â”œâ”€ ä¸èƒ½é‚€è«‹å¤–éƒ¨äººå“¡
â”‚  â”œâ”€ å¯è¨­å®šåœ˜éšŠå…§è§’è‰² (Lead/Member)
â”‚  â””â”€ å¯ç§»é™¤æˆå“¡
â”‚
â”œâ”€ åœ˜éšŠè¨­å®š
â”‚  â”œâ”€ åœ˜éšŠåœ–æ¨™
â”‚  â””â”€ é€šçŸ¥è¨­å®š
â”‚
â””â”€ æŒ‡æ´¾çš„å·¥ä½œå€
   â”œâ”€ åˆ—å‡ºæ­¤ Team è¢«æŒ‡æ´¾åˆ°çš„æ‰€æœ‰ Workspace
   â”œâ”€ é¡¯ç¤ºæ¯å€‹ Workspace çš„æ¬Šé™
   â””â”€ å¯å¿«é€Ÿè·³è½‰åˆ°å°æ‡‰ Workspace
```

**é—œéµé™åˆ¶**:
- âŒ ä¸èƒ½é‚€è«‹å¤–éƒ¨äººå“¡åŠ å…¥ Team
- âŒ Team æˆå“¡å¿…é ˆå…ˆæ˜¯çµ„ç¹”æˆå“¡
- âœ… å¦‚æœè¦ç§»é™¤çµ„ç¹”æˆå“¡,éœ€å…ˆå°‡å…¶å¾æ‰€æœ‰ Team ä¸­ç§»é™¤
- âœ… Team è² è²¬äººå¿…é ˆä¹Ÿæ˜¯ Team æˆå“¡

### 4.4 å¤¥ä¼´å‰µå»ºèˆ‡ç®¡ç†

**é‡è¦å‰æ**:
- Partner ä¸æ˜¯ç¨ç«‹å¸³è™Ÿ,æ˜¯ Organization ç®¡ç†å¤–éƒ¨å”ä½œè€…çš„æ©Ÿåˆ¶
- Partner æˆå“¡æ˜¯**å¤–éƒ¨çš„ User**,**ä¸åœ¨ Organization.memberIds ä¸­**
- Partner æˆå“¡é€éé‚€è«‹åŠ å…¥,ä½†ä¸æœƒæˆç‚ºçµ„ç¹”æ­£å¼æˆå“¡

**å»ºç«‹å¤¥ä¼´é—œä¿‚çš„æ–¹å¼**:

#### æ–¹å¼ 1: é€éèº«ä»½åˆ‡æ›å™¨
```
1. åˆ‡æ›è‡³ Organization èº«ä»½
   â†“
2. é»æ“Šèº«ä»½åˆ‡æ›å™¨
   â†“ å±•é–‹é¸å–®
3. åœ¨ã€Œå¤¥ä¼´ã€å€å¡Šä¸­é»æ“Šã€Œæ–°å¢å¤¥ä¼´ã€
   â†“
4. é–‹å•Ÿæ–°å¢å¤¥ä¼´å°è©±æ¡†
   â”œâ”€ å¤¥ä¼´åç¨± (å…¬å¸åæˆ–å€‹äººå,å¿…å¡«)
   â”œâ”€ ä¸»è¦è¯çµ¡ä¿¡ç®± (å¿…å¡«)
   â”œâ”€ å­˜å–ç­‰ç´š (Limited/Standard/Full)
   â”œâ”€ åˆç´„è³‡è¨Š (å¯é¸)
   â””â”€ æè¿° (å¯é¸)
   â†“
5. ç¢ºèªå‰µå»º
   â†“
6. Partner å¯¦é«”å‰µå»ºæˆåŠŸ
   â†“
7. é‚€è«‹å¤–éƒ¨ User åŠ å…¥æ­¤ Partner
   â”œâ”€ è¼¸å…¥å¤–éƒ¨äººå“¡çš„é›»å­éƒµä»¶
   â”œâ”€ ç³»çµ±ç™¼é€é‚€è«‹éƒµä»¶
   â””â”€ å¤–éƒ¨äººå“¡æ¥å—é‚€è«‹å¾ŒåŠ å…¥ Partner.memberIds
   â†“
8. è¨­å®šæ­¤ Partner å¯å­˜å–çš„ Workspace å’Œæ¬Šé™
```

#### æ–¹å¼ 2: é€éçµ„ç¹”è¨­å®šé é¢
```
1. åˆ‡æ›è‡³ Organization èº«ä»½
   â†“
2. é€²å…¥å·¥ä½œå€ â†’ Settings æ¨¡çµ„ â†’ å¤¥ä¼´ç®¡ç†
   â†“
3. é»æ“Šã€Œæ–°å¢å¤¥ä¼´ã€æŒ‰éˆ•
   â†“
4. (å¾ŒçºŒæµç¨‹åŒæ–¹å¼ 1)
```

**å¤¥ä¼´ç®¡ç†ä»‹é¢**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤¥ä¼´ç®¡ç† (Partners Management)    [+ æ–°å¢å¤¥ä¼´]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å¤–éƒ¨é¡§å•ã€‘                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [ğŸ¤] Design Agency Inc                       â”‚ â”‚
â”‚ â”‚      å­˜å–ç­‰ç´š: Standard                       â”‚ â”‚
â”‚ â”‚      æˆå“¡: 3 äºº (å¤–éƒ¨)                        â”‚ â”‚
â”‚ â”‚      â€¢ Alice Chen (alice@designagency.com)   â”‚ â”‚
â”‚ â”‚      â€¢ Bob Lin (bob@designagency.com)        â”‚ â”‚
â”‚ â”‚      æˆæ¬Š Workspace:                          â”‚ â”‚
â”‚ â”‚      â€¢ Marketing Campaign (Editor)           â”‚ â”‚
â”‚ â”‚      â€¢ Brand Assets (Viewer)                 â”‚ â”‚
â”‚ â”‚      [ç·¨è¼¯å¤¥ä¼´] [ç®¡ç†æ¬Šé™] [åˆªé™¤]    [â‹®]      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â”‚ ã€ä¾›æ‡‰å•†ã€‘                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [ğŸ¤] Cloud Services Co                       â”‚ â”‚
â”‚ â”‚      å­˜å–ç­‰ç´š: Limited                        â”‚ â”‚
â”‚ â”‚      æˆå“¡: 2 äºº (å¤–éƒ¨)                        â”‚ â”‚
â”‚ â”‚      â€¢ John Wu (john@cloudservices.com)      â”‚ â”‚
â”‚ â”‚      æˆæ¬Š Workspace:                          â”‚ â”‚
â”‚ â”‚      â€¢ Infrastructure (Viewer, åƒ…é™ç‰¹å®šæ¨¡çµ„)  â”‚ â”‚
â”‚ â”‚      [ç·¨è¼¯å¤¥ä¼´] [ç®¡ç†æ¬Šé™] [åˆªé™¤]    [â‹®]      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¤¥ä¼´è©³æƒ…é é¢**:
```
å¤¥ä¼´è©³æƒ… - Design Agency Inc
â”œâ”€ åŸºæœ¬è³‡è¨Š
â”‚  â”œâ”€ å¤¥ä¼´åç¨± (å¯ç·¨è¼¯)
â”‚  â”œâ”€ ä¸»è¦è¯çµ¡ä¿¡ç®± (å¯ç·¨è¼¯)
â”‚  â”œâ”€ å­˜å–ç­‰ç´š (å¯èª¿æ•´)
â”‚  â”œâ”€ åˆç´„è³‡è¨Š (å¯ç·¨è¼¯)
â”‚  â””â”€ æ‰€å±¬çµ„ç¹” (å”¯è®€)
â”‚
â”œâ”€ æˆå“¡åˆ—è¡¨ (å¤–éƒ¨äººå“¡)
â”‚  â”œâ”€ Alice Chen (alice@designagency.com)
â”‚  â”‚   â””â”€ è§’è‰²: Partner Admin
â”‚  â”œâ”€ Bob Lin (bob@designagency.com)
â”‚  â”‚   â””â”€ è§’è‰²: Collaborator
â”‚  â”œâ”€ [+ é‚€è«‹æ–°æˆå“¡] (é€éé›»å­éƒµä»¶)
â”‚  â””â”€ å¯ç§»é™¤æˆå“¡
â”‚
â”œâ”€ æˆæ¬Šçš„å·¥ä½œå€
â”‚  â”œâ”€ Marketing Campaign
â”‚  â”‚   â”œâ”€ æ¬Šé™: Editor
â”‚  â”‚   â”œâ”€ å…è¨±æ¨¡çµ„: Documents, Tasks
â”‚  â”‚   â””â”€ é™åˆ¶: ä¸å¯åŒ¯å‡º, ä¸å¯é‚€è«‹
â”‚  â”œâ”€ Brand Assets
â”‚  â”‚   â”œâ”€ æ¬Šé™: Viewer
â”‚  â”‚   â””â”€ å…è¨±æ¨¡çµ„: Documents (å”¯è®€)
â”‚  â””â”€ [+ æˆæ¬Šæ–°å·¥ä½œå€]
â”‚
â””â”€ å­˜å–è¨˜éŒ„
   â”œâ”€ æœ€å¾Œå­˜å–æ™‚é–“
   â”œâ”€ å­˜å–é »ç‡
   â””â”€ æ“ä½œæ—¥èªŒ
```

**å¤¥ä¼´å­˜å–æ§åˆ¶**:
```typescript
interface PartnerAccess {
  partnerId: string;
  workspaceId: string;
  allowedModules: ModuleType[];
  restrictions: {
    canExport: boolean;
    canInvite: boolean;
    canDelete: boolean;
    canComment: boolean;
    canEdit: boolean;
  };
  expiresAt?: Timestamp;
  grantedAt: Timestamp;
  grantedBy: string;           // User.id
}
```

**é‚€è«‹å¤–éƒ¨äººå“¡æµç¨‹**:
```
1. Partner å·²å‰µå»º
   â†“
2. é»æ“Šã€Œé‚€è«‹æ–°æˆå“¡ã€
   â†“
3. è¼¸å…¥å¤–éƒ¨äººå“¡çš„é›»å­éƒµä»¶
   â”œâ”€ ä¾‹: consultant@external.com
   â”œâ”€ è¨­å®šè§’è‰²: Partner Admin / Collaborator
   â””â”€ é™„åŠ è¨Šæ¯ (å¯é¸)
   â†“
4. ç³»çµ±ç™¼é€é‚€è«‹éƒµä»¶
   â†“
5. å¤–éƒ¨äººå“¡æ”¶åˆ°éƒµä»¶
   â”œâ”€ å¦‚æœå·²æœ‰å¸³è™Ÿ: ç›´æ¥æ¥å—é‚€è«‹
   â””â”€ å¦‚æœæ²’æœ‰å¸³è™Ÿ: å…ˆè¨»å†Š,å†æ¥å—é‚€è«‹
   â†“
6. æ¥å—é‚€è«‹å¾Œ
   â”œâ”€ User.id åŠ å…¥ Partner.memberIds
   â”œâ”€ User ä¸åŠ å…¥ Organization.memberIds
   â””â”€ User ä»¥è‡ªå·±çš„èº«ä»½ç™»å…¥,å¯å­˜å–è¢«æˆæ¬Šçš„è³‡æº
```

**å¤–éƒ¨äººå“¡çš„ä½¿ç”¨é«”é©—**:
```
1. å¤–éƒ¨ User (consultant@external.com) ç™»å…¥ç³»çµ±
   â†“
2. ä»¥è‡ªå·±çš„ User èº«ä»½ç™»å…¥
   â†“
3. åœ¨å·¥ä½œå€åˆ‡æ›å™¨ä¸­
   â”œâ”€ çœ‹åˆ°ã€Œå¤–éƒ¨å”ä½œã€å€å¡Š
   â””â”€ åˆ—å‡ºè¢«æˆæ¬Šçš„ Workspace
       â””â”€ [ğŸ¤] Marketing Campaign (Partner Access)
   â†“
4. é»æ“Šé€²å…¥ Workspace
   â”œâ”€ åªèƒ½çœ‹åˆ°è¢«å…è¨±çš„æ¨¡çµ„
   â”œâ”€ æ“ä½œå—åˆ°é™åˆ¶ (æ ¹æ“š restrictions è¨­å®š)
   â””â”€ ä»‹é¢æ¨™è¨»ã€ŒPartner Accessã€æç¤ºå—é™å­˜å–
```

**é—œéµå·®ç•°ç¸½çµ**:

| ç‰¹æ€§ | Organization Member | Partner Member |
|------|-------------------|----------------|
| æ˜¯å¦åœ¨ Organization.memberIds | âœ… æ˜¯ | âŒ å¦ |
| å¯å¦åŠ å…¥ Team | âœ… å¯ä»¥ | âŒ ä¸å¯ä»¥ |
| å­˜å–ç¯„åœ | çµ„ç¹”å±¤ç´šé è¨­æ¬Šé™ | åƒ…é™æˆæ¬Šçš„ Workspace |
| é‚€è«‹æ–¹å¼ | çµ„ç¹”ç›´æ¥é‚€è«‹ | é€é Partner é‚€è«‹ |
| ç®¡ç†ä½ç½® | çµ„ç¹”æˆå“¡ç®¡ç† | å¤¥ä¼´ç®¡ç† |
| ä½¿ç”¨é«”é©— | å®Œæ•´çµ„ç¹”æˆå“¡é«”é©— | å—é™çš„å¤–éƒ¨å”ä½œé«”é©— |

### 4.5 çµ„ç¹”å±¤ç´šçš„ Workspace ç®¡ç†

**Organization æ“æœ‰çš„ Workspace**:
- Organization å¯å‰µå»ºå¤šå€‹ Workspace
- æ¯å€‹ Workspace å¯ç¨ç«‹é…ç½®æ¨¡çµ„
- å¯å°‡ç‰¹å®š Team æŒ‡æ´¾åˆ°ç‰¹å®š Workspace
- å¯æˆæ¬Š Partner å­˜å–ç‰¹å®š Workspace

**Workspace æŒ‡æ´¾ç¤ºä¾‹**:
```
Acme Corp (Organization)
â”œâ”€ Marketing Campaign (Workspace)
â”‚  â”œâ”€ æŒ‡æ´¾åœ˜éšŠ: Marketing Team
â”‚  â”œâ”€ æˆæ¬Šå¤¥ä¼´: Design Agency Inc.
â”‚  â””â”€ å•Ÿç”¨æ¨¡çµ„: Documents, Tasks, Calendar
â”‚
â”œâ”€ Engineering Projects (Workspace)
â”‚  â”œâ”€ æŒ‡æ´¾åœ˜éšŠ: Engineering Team, QA Team
â”‚  â””â”€ å•Ÿç”¨æ¨¡çµ„: Overview, Documents, Tasks, Calendar
â”‚
â””â”€ Client Portal (Workspace)
   â”œâ”€ æˆæ¬Šå¤¥ä¼´: Client ABC Corp
   â””â”€ å•Ÿç”¨æ¨¡çµ„: Documents, Tasks (åƒ…é™æŸ¥çœ‹)
```

---

## 5. åˆ‡æ›å™¨ç³»çµ±è¨­è¨ˆ

### 5.1 Identity Switcher (Account Switcher, å¿…å‚™)

**è¨­è¨ˆç›®æ¨™**:
- ä½¿ç”¨è€…å¯åœ¨ **User / Organization / Team / Partner** ä¹‹é–“å¿«é€Ÿåˆ‡æ›
- Team/Partner ç‚º **Organization çš„æˆå“¡åˆ†çµ„è¦–è§’**ï¼Œä¸æ˜¯ç¨ç«‹ç™»å…¥èº«ä»½
- åˆ‡æ›åƒ…æ”¹è®Š **ä½œç”¨ä¸­ä¸Šä¸‹æ–‡**ï¼Œä¸æ”¹è®Šå·²ç™»å…¥èº«ä»½
- Workspace å§‹çµ‚æ˜¯ç¨ç«‹é‚è¼¯å®¹å™¨ï¼Œä¸å› åˆ‡æ›è€Œåˆä½µæˆ–æ··æ·†è³‡æ–™çµæ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€Personal accountã€‘                   â”‚
â”‚   [ğŸ‘¤] John Doe                        â”‚
â”‚    User                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€Organizationã€‘                       â”‚
â”‚ âœ“ [ğŸ¢] Acme Corporation                â”‚
â”‚    Organization Â· Owner                â”‚
â”‚   [ğŸ¢] Tech Startup Inc                â”‚
â”‚    Organization Â· Admin                â”‚
â”‚   [+ New Organization]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€Teamã€‘(Acme Corporation)              â”‚
â”‚   [ğŸ‘¥] Engineering Team                â”‚
â”‚    12 member Â· John Doe (Lead)         â”‚
â”‚   [ğŸ‘¥] Design Team                     â”‚
â”‚    8 member Â· Jane Smith (Lead)        â”‚
â”‚   [+ New Team]                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€Partnerã€‘(Acme Corporation)           â”‚
â”‚   [ğŸ¤] Design Agency Inc               â”‚
â”‚    3 member Â· Standard Access          â”‚
â”‚   [ğŸ¤] Cloud Services Co               â”‚
â”‚    2 member Â· Limited Access           â”‚
â”‚   [+ New Partner]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åˆ‡æ›è¦å‰‡**:
- **User/Organization**: ç›´æ¥åˆ‡æ›ä¸»èº«ä»½
- **Team/Partner**: åƒ…åœ¨æ‰€å±¬ Organization ä¸‹é¡¯ç¤ºï¼Œåˆ‡æ›å¾Œä¿ç•™ Organization èº«ä»½
 - **åªèƒ½å­˜åœ¨ä¸€å€‹ Identity Switcher èˆ‡ä¸€å€‹ Workspace Switcher**

**åŠŸèƒ½å®šä½**:
 - åœ¨ä¸åŒå¸³è™Ÿèº«ä»½ (User / Organization) ä¹‹é–“å¿«é€Ÿåˆ‡æ›
 - çµ±ä¸€ç®¡ç†æ‰€æœ‰å¯ç”¨èº«ä»½
 - æ”¯æ´ç›´æ¥å‰µå»ºæ–°çµ„ç¹”
 - **ç•¶åˆ‡æ›åˆ° Organization èº«ä»½æ™‚**,å‹•æ…‹é¡¯ç¤ºè©²çµ„ç¹”çš„ Team å’Œ Partner ä¸Šä¸‹æ–‡å€å¡Š

**ä½ç½®**: Header å³ä¸Šè§’

**è§¸ç™¼æ–¹å¼**: é»æ“Šè§¸ç™¼ MatMenu

**éµç›¤å¿«æ·éµ**: `Ctrl/Cmd + Shift + A`

---

#### 5.1.1 è¦–è¦ºçµæ§‹ - User èº«ä»½æ™‚

**è§¸ç™¼æŒ‰éˆ•**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Avatar] Current Account [â–¼]      â”‚
â”‚  32px    14px/500        Icon      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸‹æ‹‰é¸å–®å…§å®¹ (User èº«ä»½)**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€å€‹äººå¸³è™Ÿã€‘                            â”‚
â”‚ âœ“ [ğŸ‘¤] John Doe                       â”‚
â”‚    User                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€çµ„ç¹”ã€‘                                â”‚
â”‚   [ğŸ¢] Acme Corporation               â”‚
â”‚    Organization Â· Owner                â”‚
â”‚   [ğŸ¢] Tech Startup Inc               â”‚
â”‚    Organization Â· Admin                â”‚
â”‚   [+ å»ºç«‹æ–°çµ„ç¹”]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [âš™ï¸] ç®¡ç†å¸³è™Ÿ...                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é‡è¦èªªæ˜**:
- Team / Partner ä¸æ˜¯ç™»å…¥èº«ä»½ï¼Œä½†åœ¨åˆ‡æ›åˆ° Organization èº«ä»½å¾Œæœƒå‡ºç¾ **Team/Partner ä¸Šä¸‹æ–‡** é¸æ“‡

---

#### 5.1.2 è¦–è¦ºçµæ§‹ - Organization èº«ä»½æ™‚

**è§¸ç™¼æŒ‰éˆ•**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Logo] Acme Corporation [â–¼]       â”‚
â”‚  32px  14px/500         Icon       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸‹æ‹‰é¸å–®å…§å®¹ (Organization èº«ä»½)**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€å€‹äººå¸³è™Ÿã€‘                            â”‚
â”‚   [ğŸ‘¤] John Doe                       â”‚
â”‚    User                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€çµ„ç¹”ã€‘                                â”‚
â”‚ âœ“ [ğŸ¢] Acme Corporation               â”‚
â”‚    Organization Â· Owner                â”‚
â”‚   [ğŸ¢] Tech Startup Inc               â”‚
â”‚    Organization Â· Admin                â”‚
â”‚   [+ å»ºç«‹æ–°çµ„ç¹”]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€åœ˜éšŠã€‘(Acme Corporation)              â”‚ â† åƒ…åœ¨ Organization èº«ä»½æ™‚é¡¯ç¤º
â”‚   [ğŸ‘¥] Engineering Team               â”‚
â”‚    12 æˆå“¡ Â· John Doe (Lead)           â”‚
â”‚   [ğŸ‘¥] Design Team                    â”‚
â”‚    8 æˆå“¡ Â· Jane Smith (Lead)          â”‚
â”‚   [ğŸ‘¥] Marketing Team                 â”‚
â”‚    6 æˆå“¡ Â· Mike Johnson (Lead)        â”‚
â”‚   [+ å»ºç«‹æ–°åœ˜éšŠ]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å¤¥ä¼´ã€‘(Acme Corporation)              â”‚ â† åƒ…åœ¨ Organization èº«ä»½æ™‚é¡¯ç¤º
â”‚   [ğŸ¤] Design Agency Inc              â”‚
â”‚    3 æˆå“¡ Â· Standard Access            â”‚
â”‚   [ğŸ¤] Cloud Services Co              â”‚
â”‚    2 æˆå“¡ Â· Limited Access             â”‚
â”‚   [ğŸ¤] Consulting Partners            â”‚
â”‚    5 æˆå“¡ Â· Full Access                â”‚
â”‚   [+ æ–°å¢å¤¥ä¼´]                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [âš™ï¸] ç®¡ç†çµ„ç¹”è¨­å®š...                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å‹•æ…‹é¡¯ç¤ºé‚è¼¯**:
```typescript
// åˆ‡æ›å™¨æ ¹æ“šç•¶å‰èº«ä»½å‹•æ…‹é¡¯ç¤ºå…§å®¹
if (currentAccount.type === 'organization') {
  // é¡¯ç¤ºè©²çµ„ç¹”çš„åœ˜éšŠåˆ—è¡¨
  showTeamsSection(currentAccount.id);
  
  // é¡¯ç¤ºè©²çµ„ç¹”çš„å¤¥ä¼´åˆ—è¡¨
  showPartnersSection(currentAccount.id);
} else {
  // User æˆ– Bot èº«ä»½æ™‚ä¸é¡¯ç¤ºåœ˜éšŠå’Œå¤¥ä¼´
  hideTeamsSection();
  hidePartnersSection();
}
```

---

#### 5.1.3 äº’å‹•è¡Œç‚º

**åˆ‡æ›åˆ° Organization**:
1. é»æ“Šç›®æ¨™ Organization
2. é—œé–‰é¸å–®
3. åŸ·è¡Œåˆ‡æ›é‚è¼¯ (GlobalShell.switchAccount)
4. é‡æ–°è¼‰å…¥å¯å­˜å–çš„ Workspace åˆ—è¡¨
5. é‡æ–°é–‹å•Ÿé¸å–®æ™‚,é¡¯ç¤ºè©² Organization çš„ Team å’Œ Partner å€å¡Š

**é»æ“Š Team é …ç›®**:
- **ä¸æœƒåˆ‡æ›ç™»å…¥èº«ä»½**ï¼Œæ”¹ç‚ºåˆ‡æ› **Team ä¸Šä¸‹æ–‡**
- é‡æ–°è¼‰å…¥ Workspace åˆ—è¡¨ä¸¦æ¨™è¨» Team æŒ‡æ´¾
- å¯é€éç®¡ç†å…¥å£æŸ¥çœ‹åœ˜éšŠè©³æƒ…èˆ‡æˆå“¡

**é»æ“Š Partner é …ç›®**:
- **ä¸æœƒåˆ‡æ›ç™»å…¥èº«ä»½**ï¼Œæ”¹ç‚ºåˆ‡æ› **Partner ä¸Šä¸‹æ–‡**
- é‡æ–°è¼‰å…¥ Workspace åˆ—è¡¨ä¸¦æ¨™è¨» Partner æˆæ¬Š
- å¯é€éç®¡ç†å…¥å£æŸ¥çœ‹å¤¥ä¼´è©³æƒ…èˆ‡æ¬Šé™

**é»æ“Š [+ å»ºç«‹æ–°åœ˜éšŠ]**:
1. é–‹å•Ÿã€Œå»ºç«‹åœ˜éšŠã€å°è©±æ¡†
2. å¡«å¯«åœ˜éšŠè³‡è¨Š (åç¨±ã€æè¿°)
3. **å¾ç•¶å‰ Organization çš„æˆå“¡åˆ—è¡¨ä¸­é¸æ“‡åœ˜éšŠæˆå“¡**
4. æŒ‡å®šåœ˜éšŠè² è²¬äºº
5. ç¢ºèªå‰µå»º

**é»æ“Š [+ æ–°å¢å¤¥ä¼´]**:
1. é–‹å•Ÿã€Œæ–°å¢å¤¥ä¼´ã€å°è©±æ¡†
2. å¡«å¯«å¤¥ä¼´è³‡è¨Š (åç¨±ã€è¯çµ¡æ–¹å¼)
3. è¨­å®šå­˜å–ç­‰ç´š (Limited/Standard/Full)
4. **é€éé›»å­éƒµä»¶é‚€è«‹å¤–éƒ¨ User**
5. è¨­å®šå¯å­˜å–çš„ Workspace å’Œæ¨¡çµ„
6. ç¢ºèªå‰µå»º

**å»ºç«‹çµ„ç¹”æµç¨‹**:
1. é»æ“Šã€Œå»ºç«‹æ–°çµ„ç¹”ã€
2. å½ˆå‡ºå»ºç«‹çµ„ç¹”å°è©±æ¡†
3. å¡«å¯«çµ„ç¹”è³‡è¨Š (åç¨±)
4. çµ„ç¹”å‰µå»ºæˆåŠŸ
5. è‡ªå‹•åˆ‡æ›è‡³æ–°çµ„ç¹”èº«ä»½
6. èº«ä»½åˆ‡æ›å™¨ç¾åœ¨é¡¯ç¤ºæ–°çµ„ç¹”çš„ Team å’Œ Partner å€å¡Š (åˆå§‹ç‚ºç©º)
7. å¼•å°å‰µå»ºç¬¬ä¸€å€‹ Workspace

---

#### 5.1.4 Team å’Œ Partner é …ç›®çš„è¦–è¦ºè¨­è¨ˆ

**Team é …ç›®æ¨£å¼**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ‘¥] Engineering Team                 â”‚
â”‚  32px  14px/500                        â”‚
â”‚      12 æˆå“¡ Â· John Doe (Lead)         â”‚
â”‚      12px/400, opacity 0.6             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Hover ç‹€æ…‹:
  - Background: rgba(0,0,0,0.04)
  - Cursor: pointer
  - é¡¯ç¤ºå³å´æ“ä½œåœ–æ¨™ (â‹®)
```

**Partner é …ç›®æ¨£å¼**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ¤] Design Agency Inc                â”‚
â”‚  32px  14px/500                        â”‚
â”‚      3 æˆå“¡ Â· Standard Access          â”‚
â”‚      12px/400, opacity 0.6             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Hover ç‹€æ…‹:
  - Background: rgba(0,0,0,0.04)
  - Cursor: pointer
  - é¡¯ç¤ºå³å´æ“ä½œåœ–æ¨™ (â‹®)
```

**å€å¡Šæ¨™é¡Œæ¨£å¼**:
```
ã€åœ˜éšŠã€‘(Acme Corporation)
ã€å¤¥ä¼´ã€‘(Acme Corporation)

Style:
  - Font: 12px / 500
  - Color: rgba(0,0,0,0.6)
  - Text-transform: uppercase
  - Letter-spacing: 0.5px
  - Padding: 8px 16px
  - Height: 32px
```

**ç©ºç‹€æ…‹è™•ç†**:
```typescript
// ç•¶çµ„ç¹”æ²’æœ‰ä»»ä½•åœ˜éšŠæ™‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€åœ˜éšŠã€‘(Acme Corporation)              â”‚
â”‚   å°šæœªå»ºç«‹ä»»ä½•åœ˜éšŠ                       â”‚
â”‚   [+ å»ºç«‹æ–°åœ˜éšŠ]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

// ç•¶çµ„ç¹”æ²’æœ‰ä»»ä½•å¤¥ä¼´æ™‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€å¤¥ä¼´ã€‘(Acme Corporation)              â”‚
â”‚   å°šæœªæ–°å¢ä»»ä½•å¤¥ä¼´                       â”‚
â”‚   [+ æ–°å¢å¤¥ä¼´]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å·¥ä½œå€åˆ‡æ›å™¨ (Workspace Switcher)

**åŠŸèƒ½å®šä½**:
- åœ¨ç•¶å‰èº«ä»½ä¸‹çš„ä¸åŒ Workspace ä¹‹é–“åˆ‡æ›
- é¡¯ç¤º Workspace ç‹€æ…‹å’Œè³‡è¨Š
- æ”¯æ´å¿«é€Ÿå‰µå»ºæ–° Workspace (User å’Œ Organization èº«ä»½)

**ä½ç½®**: Header å·¦ä¸Šè§’,Logo å³å´

**è§¸ç™¼æ–¹å¼**: é»æ“Šè§¸ç™¼ MatMenu

**éµç›¤å¿«æ·éµ**: `Ctrl/Cmd + K` (æ‰“é–‹ Command Palette å¼å¿«é€Ÿåˆ‡æ›å™¨)

---

#### 5.2.1 è¦–è¦ºçµæ§‹

**è§¸ç™¼æŒ‰éˆ•**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Icon] Workspace Name [â–¼]         â”‚
â”‚  24px  16px/600       Icon         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 5.2.2 ä¸‹æ‹‰é¸å–®å…§å®¹ - User èº«ä»½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ”] æœå°‹å·¥ä½œå€...                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€æœ€è¿‘ä½¿ç”¨ã€‘                            â”‚
â”‚ âœ“ [ğŸ“] Personal Notes                 â”‚
â”‚    Owner                               â”‚
â”‚   [ğŸ“Š] Side Project                    â”‚
â”‚    Owner                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€æˆ‘çš„å·¥ä½œå€ã€‘                          â”‚
â”‚   [ğŸ“] Documents Archive              â”‚
â”‚    Owner                               â”‚
â”‚   [ğŸ’¡] Ideas & Research               â”‚
â”‚    Owner                               â”‚
â”‚   [+ å»ºç«‹å€‹äººå·¥ä½œå€]                    â”‚ â† User å¯å‰µå»º
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 5.2.3 ä¸‹æ‹‰é¸å–®å…§å®¹ - Organization èº«ä»½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ”] æœå°‹å·¥ä½œå€...                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€æœ€è¿‘ä½¿ç”¨ã€‘                            â”‚
â”‚ âœ“ [ğŸ“] Marketing Campaign             â”‚
â”‚    Owner Â· 12 members                  â”‚
â”‚   [ğŸ“Š] Q4 Analytics                    â”‚
â”‚    Member Â· 8 members                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€çµ„ç¹”å·¥ä½œå€ã€‘                          â”‚
â”‚   [ğŸ¢] Client Portal                   â”‚
â”‚    Admin                               â”‚
â”‚   [ğŸ’¼] HR Department                   â”‚
â”‚    Member                              â”‚
â”‚   [ğŸ”§] Engineering Projects            â”‚
â”‚    Engineering Team (æŒ‡æ´¾)             â”‚ â† æ¨™è¨»æŒ‡æ´¾çš„ Team
â”‚   [+ å»ºç«‹çµ„ç¹”å·¥ä½œå€]                    â”‚ â† Organization å¯å‰µå»º
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€é€éåœ˜éšŠå­˜å–ã€‘                        â”‚ â† é€é Team æŒ‡æ´¾ç²å¾—å­˜å–æ¬Š
â”‚   [ğŸ‘¥] Product Development             â”‚
â”‚    (Engineering Team æŒ‡æ´¾)             â”‚
â”‚   [ğŸ‘¥] Design System                   â”‚
â”‚    (Design Team æŒ‡æ´¾)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å¤–éƒ¨å”ä½œã€‘                            â”‚ â† ä½œç‚º Partner å”ä½œè€…å­˜å–
â”‚   [ğŸ¤] Client ABC Project             â”‚
â”‚    (Partner Access Â· å—é™å­˜å–)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**èªªæ˜**:
- ã€Œé€éåœ˜éšŠå­˜å–ã€: é¡¯ç¤ºå›  User æ˜¯æŸ Team æˆå“¡,è€Œè©² Team è¢«æŒ‡æ´¾åˆ°çš„ Workspace
- ã€Œå¤–éƒ¨å”ä½œã€: é¡¯ç¤º User ä½œç‚ºæŸ Partner çš„æˆå“¡,è¢«æˆæ¬Šå­˜å–çš„ Workspace

---

#### 5.2.4 é—œéµè¦å‰‡

**User èº«ä»½ä¸‹**:
- âœ… å¯å‰µå»ºå’Œç®¡ç†å€‹äºº Workspace
- âœ… å¯æŸ¥çœ‹è‡ªå·±æ“æœ‰çš„æ‰€æœ‰ Workspace
- âœ… ç„¡æ³•çœ‹åˆ°å…¶ä»–çµ„ç¹”çš„ Workspace (é™¤éåˆ‡æ›åˆ°è©²çµ„ç¹”èº«ä»½)

**Organization èº«ä»½ä¸‹**:
- âœ… å¯å‰µå»ºå’Œç®¡ç†çµ„ç¹” Workspace
- âœ… å¯æŸ¥çœ‹çµ„ç¹”æ“æœ‰çš„æ‰€æœ‰ Workspace
- âœ… å¯çœ‹åˆ°é€é Team æŒ‡æ´¾ç²å¾—å­˜å–æ¬Šçš„ Workspace
- âœ… å¯çœ‹åˆ°ä½œç‚º Partner è¢«æˆæ¬Šçš„ Workspace (æ¨™è¨»ç‚ºå¤–éƒ¨å”ä½œ)

**é‡è¦**: Team / Partner ä¸æ˜¯ç™»å…¥èº«ä»½ï¼Œä½† Identity Switcher æœƒè¨­å®šå…¶ä¸Šä¸‹æ–‡:
- âœ… Workspace åˆ—è¡¨ä»åœ¨ Organization èº«ä»½ä¸‹é¡¯ç¤º
- âœ… ä¾ Team / Partner ä¸Šä¸‹æ–‡ç¯©é¸å¯è¦‹ Workspace

---

#### 5.2.5 å‰µå»º Workspace æµç¨‹

**User å‰µå»ºå€‹äºº Workspace**:
```
å·¥ä½œå€åˆ‡æ›å™¨ (User èº«ä»½)
  â†“ é»æ“Šã€Œå»ºç«‹å€‹äººå·¥ä½œå€ã€
å»ºç«‹å·¥ä½œå€å°è©±æ¡†
  â”œâ”€ å·¥ä½œå€åç¨± (å¿…å¡«)
  â”œâ”€ æè¿° (å¯é¸)
  â””â”€ åˆå§‹æ¨¡çµ„é¸æ“‡
  â†“ ç¢ºèª
å·¥ä½œå€å‰µå»ºæˆåŠŸ
  â†“ è‡ªå‹•åˆ‡æ›è‡³æ–°å·¥ä½œå€
  â†“ ownerId = user.id
  â†“ ownerType = 'user'
```

**Organization å‰µå»ºçµ„ç¹” Workspace**:
```
å·¥ä½œå€åˆ‡æ›å™¨ (Organization èº«ä»½)
  â†“ é»æ“Šã€Œå»ºç«‹çµ„ç¹”å·¥ä½œå€ã€
å»ºç«‹å·¥ä½œå€å°è©±æ¡†
  â”œâ”€ å·¥ä½œå€åç¨± (å¿…å¡«)
  â”œâ”€ æè¿° (å¯é¸)
  â””â”€ åˆå§‹æ¨¡çµ„é¸æ“‡
  â†“ ç¢ºèª
å·¥ä½œå€å‰µå»ºæˆåŠŸ
  â†“ è‡ªå‹•åˆ‡æ›è‡³æ–°å·¥ä½œå€
  â†“ ownerId = organization.id
  â†“ ownerType = 'organization'
  â†“
å·¥ä½œå€åˆå§‹è¨­å®šå¼•å°
  â”œâ”€ é‚€è«‹æˆå“¡ (å¾çµ„ç¹”æˆå“¡ä¸­é¸æ“‡)
  â”œâ”€ æŒ‡æ´¾åœ˜éšŠ (å¾çµ„ç¹”åœ˜éšŠä¸­é¸æ“‡)
  â””â”€ æˆæ¬Šå¤¥ä¼´ (å¾çµ„ç¹”å¤¥ä¼´ä¸­é¸æ“‡)
```

---

#### 5.2.6 Workspace é …ç›®çš„æ¨™è¨»èªªæ˜

**æ¨™è¨»é¡å‹**:
```typescript
// Owner (æ“æœ‰è€…)
[ğŸ“] Marketing Campaign
Owner

// ç›´æ¥æˆå“¡
[ğŸ“Š] Analytics Dashboard  
Member

// é€é Team æŒ‡æ´¾
[ğŸ”§] Engineering Projects
Engineering Team (æŒ‡æ´¾)

// Partner å”ä½œ
[ğŸ¤] Client Portal
Partner Access (å—é™)
```

**è¦–è¦ºå·®ç•°**:
- Owner: é¡¯ç¤ºã€ŒOwnerã€æ¨™ç±¤,å¯å®Œæ•´ç®¡ç†
- Member: é¡¯ç¤ºè§’è‰² (Admin/Editor/Viewer)
- Team: é¡¯ç¤º Team åç¨±,æ¨™è¨»ã€ŒæŒ‡æ´¾ã€
- Partner: é¡¯ç¤ºã€ŒPartner Accessã€,æ¨™è¨»å­˜å–ç­‰ç´š

### 5.3 çµ„ç¹”å…§å»ºç«‹åœ˜éšŠçš„å¿«æ·å…¥å£

**åœ¨åˆ‡æ›å™¨ä¸­é¡¯ç¤ºåœ˜éšŠç®¡ç†**:
```
èº«ä»½åˆ‡æ›å™¨ (Organization èº«ä»½ä¸‹)
  â†“ é»æ“Šã€Œç®¡ç†çµ„ç¹”ã€
çµ„ç¹”ç®¡ç†é¸å–®
  â”œâ”€ [ğŸ‘¥] ç®¡ç†åœ˜éšŠ
  â”‚    â†“ é»æ“Š
  â”‚    åœ˜éšŠç®¡ç†é é¢
  â”‚      â”œâ”€ ç¾æœ‰åœ˜éšŠåˆ—è¡¨
  â”‚      â””â”€ [+ å»ºç«‹æ–°åœ˜éšŠ] æŒ‰éˆ•
  â”‚
  â”œâ”€ [ğŸ¤] ç®¡ç†å¤¥ä¼´
  â”‚    â†“ é»æ“Š
  â”‚    å¤¥ä¼´ç®¡ç†é é¢
  â”‚      â”œâ”€ ç¾æœ‰å¤¥ä¼´åˆ—è¡¨
  â”‚      â””â”€ [+ æ–°å¢å¤¥ä¼´] æŒ‰éˆ•
  â”‚
  â”œâ”€ [ğŸ‘¤] ç®¡ç†æˆå“¡
  â””â”€ [âš™ï¸] çµ„ç¹”è¨­å®š
```

**å¿«é€Ÿæ“ä½œæŒ‰éˆ•**:
- åœ¨ Organization èº«ä»½ä¸‹çš„ Header å¢åŠ å¿«é€Ÿæ“ä½œæŒ‰éˆ•
- å…è¨±ç›´æ¥è·³è½‰è‡³åœ˜éšŠ/å¤¥ä¼´ç®¡ç†
- æ”¯æ´å¿«é€Ÿå‰µå»ºåœ˜éšŠ/å¤¥ä¼´

---

## 6. å…¨å±€å¸ƒå±€æ¶æ§‹

### 6.1 æ•´é«”é é¢çµæ§‹

> UI å…ƒç´  (Logo/Avatar) ç‚º Presentation å±¤è³‡è¨Šï¼Œä¸å±¬æ–¼ Domain Entity æ¬„ä½ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Global Header (64px, å›ºå®š)                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Logo â”‚Workspaceâ–¼â”‚[Search]  â”‚[ğŸ””][âš™ï¸]â”‚Account â–¼â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚             â”‚                                 â”‚   â”‚
â”‚ â”‚   Sidebar   â”‚      Main Content Area          â”‚   â”‚
â”‚ â”‚   (240px)   â”‚                                 â”‚   â”‚
â”‚ â”‚             â”‚                                 â”‚   â”‚
â”‚ â”‚ æ¨¡çµ„å°èˆª:    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚ â”‚ â€¢ Overview  â”‚  â”‚ Module Toolbar            â”‚ â”‚   â”‚
â”‚ â”‚ â€¢ Documents â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚   â”‚
â”‚ â”‚ â€¢ Tasks     â”‚  â”‚                           â”‚ â”‚   â”‚
â”‚ â”‚ â€¢ Calendar  â”‚  â”‚   Entity Content          â”‚ â”‚   â”‚
â”‚ â”‚ â€¢ ...       â”‚  â”‚                           â”‚ â”‚   â”‚
â”‚ â”‚             â”‚  â”‚                           â”‚ â”‚   â”‚
â”‚ â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Header è©³ç´°è¨­è¨ˆ

**Left Zone**:
- Logo (32x32px, Presentation-only)
- Workspace Switcher (280px)

**Center Zone**:
- å…¨å±€æœå°‹æ¡† (400px)
- æœå°‹ç¯„åœ: ç•¶å‰èº«ä»½å¯å­˜å–çš„æ‰€æœ‰ Workspace
- çµæœåˆ†é¡: Workspace / Documents / Tasks / Calendar

**Right Zone**:
- é€šçŸ¥ä¸­å¿ƒ (ğŸ””) - é¡¯ç¤ºæœªè®€æ•¸é‡
- è¨­å®šé¸å–® (âš™ï¸) - å…¨å±€è¨­å®šå’Œåå¥½
- Identity Switcher (Account Switcher) - èº«ä»½åˆ‡æ›å™¨

### 6.3 Sidebar æ¨¡çµ„å°èˆª

**æ¨™æº–æ¨¡çµ„** (å°æ‡‰ `ModuleType`):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ“Š] Overview           â”‚ â† ç¸½è¦½å„€è¡¨æ¿
â”‚ [ğŸ“] Documents          â”‚ â† æ–‡ä»¶ç®¡ç†
â”‚ [âœ…] Tasks        [5]   â”‚ â† ä»»å‹™ (å¾½ç« : å¾…è™•ç†æ•¸)
â”‚ [ğŸ—“ï¸] Calendar           â”‚ â† è¡Œäº‹æ›†
â”‚ [âš™ï¸] Settings           â”‚ â† å·¥ä½œå€è¨­å®š
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¹æ“šèº«ä»½å’Œæ¬Šé™å‹•æ…‹é¡¯ç¤º**:
- **Viewer**: åƒ…é¡¯ç¤º Overview, Documents (å”¯è®€), Tasks (å”¯è®€)
- **Editor**: å¢åŠ  Documents ç·¨è¼¯, Tasks ç·¨è¼¯
- **Admin**: å¢åŠ  Settings
- **Owner**: å®Œæ•´å­˜å–æ‰€æœ‰æ¨¡çµ„

### 6.4 Main Content Area

**æ¨¡çµ„ Toolbar**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ“] Documents                                 â”‚
â”‚                                                â”‚
â”‚ [ğŸ” Search] [Filter â–¼] [Sort â–¼]  [+ New]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Entity Content**:
- æ ¹æ“šä¸åŒæ¨¡çµ„é¡¯ç¤ºå°æ‡‰å…§å®¹
- æ”¯æ´åˆ—è¡¨è¦–åœ–ã€ç¶²æ ¼è¦–åœ–ã€çœ‹æ¿è¦–åœ–ç­‰
- éŸ¿æ‡‰å¼ä½ˆå±€é©é…

---

## 7. æ¬Šé™èˆ‡å­˜å–æ§åˆ¶

### 7.1 æ¬Šé™æ¨¡å‹

**å››å±¤æ¬Šé™é«”ç³»**:
```
1. Global Level (å…¨å±€å±¤ç´š)
   - System Admin (ç³»çµ±ç®¡ç†å“¡)
   - Regular User (ä¸€èˆ¬ç”¨æˆ¶)

2. Account Level (èº«ä»½å±¤ç´š)
   - Organization Owner/Admin/Member
   - Team Lead/Member
   - Partner Admin/Collaborator

3. Workspace Level (å·¥ä½œå€å±¤ç´š)
   - Owner (æ“æœ‰è€…)
   - Admin (ç®¡ç†å“¡)
   - Editor (ç·¨è¼¯è€…)
   - Viewer (æª¢è¦–è€…)

4. Entity Level (å¯¦é«”å±¤ç´š)
   - ç‰¹å®šæ–‡ä»¶/ä»»å‹™çš„å­˜å–æ¬Šé™
   - ç²¾ç´°åŒ–æ¬Šé™æ§åˆ¶
```

### 7.2 æ¬Šé™ç¹¼æ‰¿è¦å‰‡

**Organization â†’ Workspace**:
- Organization Owner è‡ªå‹•æˆç‚ºæ‰€æœ‰ Organization Workspace çš„ Owner
- Organization Admin è‡ªå‹•æˆç‚ºæ‰€æœ‰ Organization Workspace çš„ Admin
- Organization Member é è¨­ç‚º Workspace Viewer,å¯èª¿æ•´

**Team â†’ Workspace**:
- Team è¢«æŒ‡æ´¾åˆ° Workspace æ™‚,Team æˆå“¡è‡ªå‹•ç²å¾—æŒ‡å®šè§’è‰²
- ä¾‹: Engineering Team è¢«æŒ‡æ´¾ç‚ºã€ŒEngineering Projectsã€çš„ Editor

**Partner â†’ Workspace**:
- Partner è¢«æˆæ¬Šå­˜å– Workspace æ™‚,è¨­å®šå­˜å–ç­‰ç´š
- å­˜å–ç­‰ç´šæ±ºå®šå¯ç”¨æ¨¡çµ„å’Œæ“ä½œæ¬Šé™

### 7.3 æ¬Šé™æª¢æŸ¥æµç¨‹

```typescript
// æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦å¯å­˜å– Workspace
function canAccessWorkspace(
  userId: string,
  workspaceId: string,
  accountType: 'user' | 'organization' | 'team' | 'partner'
): boolean {
  // 1. æª¢æŸ¥æ˜¯å¦ç‚º Workspace Owner
  if (isWorkspaceOwner(userId, workspaceId)) return true;
  
  // 2. æª¢æŸ¥ Organization å±¤ç´šæ¬Šé™
  if (accountType === 'organization') {
    if (isOrganizationMember(userId, workspace.ownerId)) return true;
  }
  
  // 3. æª¢æŸ¥ Team å±¤ç´šæ¬Šé™
  if (accountType === 'team') {
    if (isTeamAssignedToWorkspace(teamId, workspaceId)) return true;
  }
  
  // 4. æª¢æŸ¥ Partner å±¤ç´šæ¬Šé™
  if (accountType === 'partner') {
    if (isPartnerAuthorized(partnerId, workspaceId)) return true;
  }
  
  // 5. æª¢æŸ¥ç›´æ¥æˆäºˆçš„æ¬Šé™
  if (hasDirectPermission(userId, workspaceId)) return true;
  
  return false;
}
```

---

## 8. ä½¿ç”¨è€…é«”é©—æµç¨‹

### 8.1 é¦–æ¬¡ä½¿ç”¨æµç¨‹

**æ–°ç”¨æˆ¶è¨»å†Š**:
```
1. ç”¨æˆ¶è¨»å†Š â†’ å‰µå»º User å¸³è™Ÿ
   â†“
2. æ­¡è¿ç•«é¢ â†’ é¸æ“‡ä½¿ç”¨æƒ…å¢ƒ
   â”œâ”€ å€‹äººä½¿ç”¨ â†’ å¼•å°å‰µå»ºå€‹äºº Workspace
   â””â”€ åœ˜éšŠå”ä½œ â†’ å¼•å°å‰µå»º Organization
   â†“
3. å‰µå»ºç¬¬ä¸€å€‹å¯¦é«” (Workspace æˆ– Organization)
   â†“
4. å®Œæˆåˆå§‹è¨­å®š (é ­åƒã€åå¥½è¨­å®š)
   â†“
5. é€²å…¥ä¸»ä»‹é¢
```

**åŠ å…¥ç¾æœ‰çµ„ç¹”**:
```
1. æ”¶åˆ°çµ„ç¹”é‚€è«‹éƒµä»¶
   â†“
2. é»æ“Šæ¥å—é‚€è«‹
   â†“
3. ç™»å…¥æˆ–è¨»å†Šå¸³è™Ÿ
   â†“
4. è‡ªå‹•åŠ å…¥çµ„ç¹”
   â†“
5. èº«ä»½åˆ‡æ›å™¨é¡¯ç¤ºæ–°çµ„ç¹”
   â†“
6. åˆ‡æ›è‡³çµ„ç¹”èº«ä»½,æŸ¥çœ‹å¯å­˜å–çš„ Workspace
```

### 8.2 æ—¥å¸¸ä½¿ç”¨æµç¨‹

**åˆ‡æ›èº«ä»½ä¸¦ç®¡ç†çµ„ç¹”**:
```
1. ç”¨æˆ¶ç™»å…¥ â†’ é è¨­é¡¯ç¤ºä¸Šæ¬¡ä½¿ç”¨çš„èº«ä»½
   â†“
2. é»æ“Šèº«ä»½åˆ‡æ›å™¨
   â†“
3. é¸æ“‡ã€ŒAcme Corporation (Organization)ã€
   â†“
4. ç³»çµ±åˆ‡æ›è‡³ Organization èº«ä»½
   â”œâ”€ è¼‰å…¥è©²çµ„ç¹”çš„ Workspace åˆ—è¡¨
   â”œâ”€ èº«ä»½åˆ‡æ›å™¨ç¾åœ¨é¡¯ç¤ºè©²çµ„ç¹”çš„ Team å’Œ Partner å€å¡Š
   â””â”€ Header é¡¯ç¤ºçµ„ç¹” Logo å’Œåç¨±
   â†“
5. ç”¨æˆ¶é¸æ“‡ã€ŒMarketing Campaignã€Workspace
   â†“
6. é€²å…¥ Workspace,æŸ¥çœ‹ Overview æ¨¡çµ„
```

**åœ¨çµ„ç¹”å…§å‰µå»ºåœ˜éšŠ**:
```
1. èº«ä»½: Acme Corporation (Organization Owner)
   â†“
2. é»æ“Šèº«ä»½åˆ‡æ›å™¨
   â†“ å±•é–‹é¸å–®,çœ‹åˆ°ã€Œåœ˜éšŠã€å€å¡Š
3. é»æ“Šã€Œå»ºç«‹æ–°åœ˜éšŠã€
   â†“
4. å¡«å¯«åœ˜éšŠè³‡è¨Š
   â”œâ”€ åœ˜éšŠåç¨±: Engineering Team
   â”œâ”€ è² è²¬äºº: John Doe (å¾çµ„ç¹”æˆå“¡ä¸­é¸æ“‡)
   â””â”€ æˆå“¡: Alice, Bob, Charlie (å¾çµ„ç¹”æˆå“¡ä¸­å¤šé¸)
   â†“
5. åœ˜éšŠå‰µå»ºæˆåŠŸ
   â”œâ”€ è‡ªå‹•åŠ å…¥ Organization.teamIds
   â””â”€ èº«ä»½åˆ‡æ›å™¨çš„ã€Œåœ˜éšŠã€å€å¡Šä¸­é¡¯ç¤ºæ–°åœ˜éšŠ
   â†“
6. å¯å°‡åœ˜éšŠæŒ‡æ´¾åˆ°ç‰¹å®š Workspace
```

**å°‡åœ˜éšŠæŒ‡æ´¾åˆ° Workspace**:
```
1. èº«ä»½: Acme Corporation (Organization)
   â†“
2. å·¥ä½œå€åˆ‡æ›å™¨ â†’ é¸æ“‡ã€ŒEngineering Projectsã€
   â†“
3. Sidebar â†’ ã€ŒSettingsã€æ¨¡çµ„ (å­˜å–æ§åˆ¶)
   â†“
4. é»æ“Šã€ŒæŒ‡æ´¾åœ˜éšŠã€
   â†“
5. é¸æ“‡ Engineering Team
   â”œâ”€ é¡¯ç¤ºåœ˜éšŠæˆå“¡åˆ—è¡¨é è¦½
   â””â”€ è¨­å®šåœ˜éšŠè§’è‰²: Editor
   â†“
6. ç¢ºèªæŒ‡æ´¾
   â†“
7. Engineering Team æ‰€æœ‰æˆå“¡è‡ªå‹•ç²å¾—æ­¤ Workspace çš„ Editor æ¬Šé™
   â†“
8. Team æˆå“¡åœ¨å·¥ä½œå€åˆ‡æ›å™¨ä¸­çœ‹åˆ°æ­¤ Workspace
   â””â”€ æ¨™è¨»ç‚ºã€Œ(Engineering Team æŒ‡æ´¾)ã€
```

**æˆæ¬Šå¤¥ä¼´å­˜å– Workspace**:
```
1. èº«ä»½: Acme Corporation (Organization)
   â†“
2. é»æ“Šèº«ä»½åˆ‡æ›å™¨
   â†“ å±•é–‹é¸å–®,çœ‹åˆ°ã€Œå¤¥ä¼´ã€å€å¡Š
3. é»æ“Šã€Œæ–°å¢å¤¥ä¼´ã€
   â†“
4. å¡«å¯«å¤¥ä¼´è³‡è¨Š
   â”œâ”€ å¤¥ä¼´åç¨±: Design Agency Inc
   â”œâ”€ è¯çµ¡ä¿¡ç®±: contact@designagency.com
   â””â”€ å­˜å–ç­‰ç´š: Standard
   â†“
5. å¤¥ä¼´å‰µå»ºæˆåŠŸ
   â†“
6. é‚€è«‹å¤–éƒ¨ User åŠ å…¥æ­¤ Partner
   â”œâ”€ è¼¸å…¥: alice@designagency.com
   â”œâ”€ ç³»çµ±ç™¼é€é‚€è«‹éƒµä»¶
   â””â”€ Alice æ¥å—é‚€è«‹ (ä¸åŠ å…¥ Organization.memberIds)
   â†“
7. æˆæ¬Š Partner å­˜å– Workspace
   â”œâ”€ é¸æ“‡ Workspace: Marketing Campaign
   â”œâ”€ å…è¨±æ¨¡çµ„: Documents (Read/Write), Tasks (Read)
   â””â”€ é™åˆ¶: ä¸å¯åŒ¯å‡ºã€ä¸å¯é‚€è«‹
   â†“
8. Alice ä»¥è‡ªå·±çš„ User èº«ä»½ç™»å…¥
   â”œâ”€ åœ¨å·¥ä½œå€åˆ‡æ›å™¨çš„ã€Œå¤–éƒ¨å”ä½œã€å€å¡Š
   â””â”€ çœ‹åˆ°ã€ŒMarketing Campaign (Partner Access)ã€
   â†“
9. Alice é€²å…¥ Workspace
   â”œâ”€ åªèƒ½çœ‹åˆ° Documents å’Œ Tasks æ¨¡çµ„
   â”œâ”€ Documents å¯è®€å¯«,Tasks åƒ…å¯è®€
   â””â”€ ä»‹é¢æ¨™è¨»ã€ŒPartner Access - å—é™å­˜å–ã€
```

### 8.3 è·¨èº«ä»½å”ä½œæµç¨‹

**æƒ…å¢ƒ: å€‹äººç”¨æˆ¶åŒæ™‚åƒèˆ‡å¤šå€‹çµ„ç¹”å’Œå°ˆæ¡ˆ**:

```
ä½¿ç”¨è€…: Alice

å¯åˆ‡æ›çš„èº«ä»½:
â”œâ”€ Alice (User) - å€‹äººå¸³è™Ÿ
â””â”€ Acme Corporation (Organization) - çµ„ç¹”èº«ä»½

å¯åˆ‡æ›çš„ä¸Šä¸‹æ–‡ (åœ¨ Organization ä¸‹):
â”œâ”€ Engineering Team
â””â”€ Partner "Consulting Group"

Alice åœ¨ Acme Corporation ä¸­çš„é—œä¿‚:
â”œâ”€ æ˜¯çµ„ç¹”çš„æ­£å¼æˆå“¡ (åœ¨ Organization.memberIds ä¸­)
â”œâ”€ æ˜¯ Engineering Team çš„æˆå“¡
â””â”€ ä½œç‚ºå¤–éƒ¨å”ä½œè€…åƒèˆ‡ Partner "Consulting Group"

å¯å­˜å–çš„ Workspace:
â”œâ”€ ä»¥ User èº«ä»½:
â”‚   â””â”€ Personal Projects (Owner)
â”‚
â””â”€ ä»¥ Organization èº«ä»½ (Acme Corporation):
    â”œâ”€ Marketing Campaign (Team æŒ‡æ´¾: Marketing Team, Role: Editor)
    â”œâ”€ Engineering Projects (Team æŒ‡æ´¾: Engineering Team, Role: Editor)
    â”œâ”€ HR Department (ç›´æ¥æˆæ¬Š, Role: Viewer)
    â””â”€ Client Portal (Partner æˆæ¬Š: Consulting Group, Limited Access)
```

**Alice çš„å·¥ä½œæµç¨‹**:

```
æ—©ä¸Š 9:00 - è™•ç†å€‹äººå¾…è¾¦
  â”œâ”€ åˆ‡æ›è‡³ã€ŒAlice (User)ã€èº«ä»½
  â”‚   â””â”€ èº«ä»½åˆ‡æ›å™¨ä¸é¡¯ç¤º Team/Partner å€å¡Š
  â”œâ”€ é–‹å•Ÿã€ŒPersonal Projectsã€Workspace
  â””â”€ åœ¨ Tasks æ¨¡çµ„ä¸­è™•ç†å€‹äººå¾…è¾¦äº‹é …

ä¸Šåˆ 10:00 - åƒèˆ‡åœ˜éšŠæœƒè­°
  â”œâ”€ åˆ‡æ›è‡³ã€ŒAcme Corporationã€èº«ä»½
  â”‚   â”œâ”€ èº«ä»½åˆ‡æ›å™¨ç¾åœ¨é¡¯ç¤º:
  â”‚   â”‚   â”œâ”€ åœ˜éšŠå€å¡Š (é¡¯ç¤º Engineering Team, Marketing Team)
  â”‚   â”‚   â””â”€ å¤¥ä¼´å€å¡Š (é¡¯ç¤º Consulting Group)
  â”‚   â””â”€ å·¥ä½œå€åˆ‡æ›å™¨é¡¯ç¤º:
  â”‚       â””â”€ ã€Œé€éåœ˜éšŠå­˜å–ã€å€å¡Š
  â”‚           â””â”€ Marketing Campaign (Marketing Team æŒ‡æ´¾)
  â”œâ”€ é–‹å•Ÿã€ŒMarketing Campaignã€Workspace
  â””â”€ åœ¨ Tasks æ¨¡çµ„ä¸­æ›´æ–°ä»»å‹™ç‹€æ…‹ (Editor æ¬Šé™)

ä¸‹åˆ 2:00 - æª¢è¦– HR æ–‡ä»¶
  â”œâ”€ ä¿æŒã€ŒAcme Corporationã€èº«ä»½
  â”œâ”€ åˆ‡æ›è‡³ã€ŒHR Departmentã€Workspace
  â”‚   â””â”€ æ¨™è¨»ç‚ºã€Œç›´æ¥æˆæ¬Š - Viewerã€
  â””â”€ åœ¨ Documents æ¨¡çµ„ä¸­æª¢è¦–æ–‡ä»¶ (åƒ…æŸ¥çœ‹,ç„¡ç·¨è¼¯æ¬Šé™)

ä¸‹åˆ 4:00 - å¤–éƒ¨é¡§å•å·¥ä½œ
  â”œâ”€ ä¿æŒã€ŒAcme Corporationã€èº«ä»½
  â”œâ”€ å·¥ä½œå€åˆ‡æ›å™¨çš„ã€Œå¤–éƒ¨å”ä½œã€å€å¡Š
  â”‚   â””â”€ Client Portal (Partner Access - Consulting Group)
  â”œâ”€ é€²å…¥ã€ŒClient Portalã€Workspace
  â”‚   â”œâ”€ ä»‹é¢æ¨™è¨»ã€ŒPartner Access - å—é™å­˜å–ã€
  â”‚   â”œâ”€ åªèƒ½çœ‹åˆ°è¢«æˆæ¬Šçš„æ¨¡çµ„ (Documents, Tasks)
  â”‚   â””â”€ ç„¡æ³•åŒ¯å‡ºã€ç„¡æ³•é‚€è«‹ä»–äºº
  â””â”€ åœ¨ Documents æ¨¡çµ„ä¸Šå‚³å®¢æˆ¶æ–‡ä»¶
```

**é—œéµç†è§£**:
1. **Alice åªæœ‰ 2 å€‹å¯ç™»å…¥èº«ä»½**: User å’Œ Organizationï¼Œä½†å¯åœ¨ Organization ä¸‹åˆ‡æ› Team/Partner ä¸Šä¸‹æ–‡
2. **Team å’Œ Partner ä¸æ˜¯èº«ä»½**: å®ƒå€‘æ˜¯ Alice åœ¨çµ„ç¹”ä¸­çš„æˆå“¡é—œä¿‚
3. **å­˜å–æ¬Šé™ä¾†æº**:
   - ç›´æ¥æˆæ¬Š: çµ„ç¹”ç›´æ¥çµ¦äºˆçš„æ¬Šé™
   - Team æŒ‡æ´¾: å› ç‚ºæ˜¯ Team æˆå“¡è€Œç²å¾—çš„æ¬Šé™
   - Partner æˆæ¬Š: ä½œç‚ºå¤–éƒ¨å”ä½œè€…è¢«æˆäºˆçš„å—é™æ¬Šé™
4. **æ‰€æœ‰æ“ä½œéƒ½åœ¨ Organization èº«ä»½ä¸‹é€²è¡Œ**: åªæ˜¯æ ¹æ“šä¸åŒçš„æˆå“¡é—œä¿‚,çœ‹åˆ°ä¸åŒçš„ Workspace å’Œæ¬Šé™

---

## 9. è³‡æ–™æ¨¡å‹é—œä¿‚

### 9.1 æ ¸å¿ƒå¯¦é«”é—œä¿‚åœ–

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    User     â”‚ â† å¯ç™»å…¥çš„å¸³è™Ÿ
                    â”‚             â”‚
                    â”‚ - id        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚         â”‚         â”‚
            åŠ å…¥çµ„ç¹”    ä½œç‚ºTeamæˆå“¡  ä½œç‚ºPartneræˆå“¡
                 â”‚         â”‚         â”‚
                 â†“         â†“         â†“
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚
          â”‚Organization â”‚ â”‚         â”‚ â† å¯ç™»å…¥çš„å¸³è™Ÿ
          â”‚             â”‚ â”‚         â”‚
          â”‚ - id        â”‚ â”‚         â”‚
          â”‚ - ownerId   â”œâ”€â”˜         â”‚
          â”‚ - memberIds â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
                 â”‚                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”          â”‚
         â”‚               â”‚          â”‚
    ç®¡ç†Team         ç®¡ç†Partner     â”‚
         â”‚               â”‚          â”‚
         â†“               â†“          â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
  â”‚     Team     â”‚ â”‚   Partner    â”‚â”‚ â† ä¸æ˜¯å¸³è™Ÿ,æ˜¯æˆå“¡åˆ†çµ„
  â”‚              â”‚ â”‚              â”‚â”‚
  â”‚ - id         â”‚ â”‚ - id         â”‚â”‚
  â”‚ - orgId      â”‚ â”‚ - orgId      â”‚â”‚
  â”‚ - memberIds  â”‚ â”‚ - memberIds  â”‚â”‚ â† å¤–éƒ¨ User,ä¸åœ¨ Org.memberIds
  â”‚   (Orgæˆå“¡)  â”‚ â”‚   (å¤–éƒ¨User)  â”‚â”‚
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
         â”‚                â”‚        â”‚
         â”‚ æŒ‡æ´¾åˆ°          â”‚ æˆæ¬Šå­˜å–â”‚
         â”‚                â”‚        â”‚
         â†“                â†“        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                  â†“                â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
      â”‚     Workspace         â”‚   â”‚
      â”‚                       â”‚   â”‚
      â”‚ - id                  â”‚   â”‚
      â”‚ - ownerId             â”‚â†â”€â”€â”˜
      â”‚   (User.id æˆ–         â”‚   å¯ä»¥æ˜¯ User æˆ–
      â”‚    Organization.id)   â”‚   Organization
      â”‚ - ownerType           â”‚
      â”‚   ('user' | 'organization') â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚ åŒ…å«
                  â†“
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚WorkspaceACL   â”‚ â† å­˜å–æ§åˆ¶åˆ—è¡¨
          â”‚               â”‚
          â”‚ - accountId   â”‚ (User/Team/Partner)
          â”‚ - accountType â”‚
          â”‚ - role        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é—œéµé—œä¿‚èªªæ˜**:

1. **User â†” Organization** (å¤šå°å¤š)
   - User å¯ä»¥åŠ å…¥å¤šå€‹ Organization
   - Organization åŒ…å«å¤šå€‹ User (memberIds)
   - é—œä¿‚: æ­£å¼æˆå“¡é—œä¿‚

2. **Organization â†’ Team** (ä¸€å°å¤š)
   - Organization ç®¡ç†å¤šå€‹ Team
   - Team å¿…é ˆéš¸å±¬æ–¼ä¸€å€‹ Organization
   - Team.memberIds å¿…é ˆæ˜¯ Organization.memberIds çš„å­é›†åˆ

3. **Organization â†’ Partner** (ä¸€å°å¤š)
   - Organization ç®¡ç†å¤šå€‹ Partner
   - Partner å¿…é ˆé—œè¯ä¸€å€‹ Organization
   - Partner.memberIds æ˜¯å¤–éƒ¨ User,ä¸åœ¨ Organization.memberIds ä¸­

4. **User â†’ Workspace** (ä¸€å°å¤š)
   - User å¯ä»¥æ“æœ‰å¤šå€‹ Workspace
   - Workspace.ownerId = User.id, ownerType = 'user'

5. **Organization â†’ Workspace** (ä¸€å°å¤š)
   - Organization å¯ä»¥æ“æœ‰å¤šå€‹ Workspace
   - Workspace.ownerId = Organization.id, ownerType = 'organization'

6. **Team â†’ Workspace** (å¤šå°å¤š,é€é ACL)
   - Team è¢«æŒ‡æ´¾åˆ° Workspace
   - Team ä¸æ“æœ‰ Workspace
   - é€é WorkspaceACL è¨˜éŒ„é—œä¿‚

7. **Partner â†’ Workspace** (å¤šå°å¤š,é€é ACL)
   - Partner è¢«æˆæ¬Šå­˜å– Workspace
   - Partner ä¸æ“æœ‰ Workspace
   - é€é WorkspaceACL è¨˜éŒ„é—œä¿‚å’Œé™åˆ¶

### 9.2 Firestore é›†åˆçµæ§‹

```
/users/{userId}
  - organizationIds, teamIds, partnerIds

/organizations/{orgId}
  - ownerId, memberIds, teamIds, partnerIds

/teams/{teamId}
  - organizationId
  - memberIds

/partners/{partnerId}
  - organizationId
  - memberIds, contactEmail

/workspaces/{workspaceId}
  - ownerId, ownerType
  - moduleIds

/workspaces/{workspaceId}/permissions/{permissionId}
  - accountId, accountType, role
  - grantedAt, grantedBy

/workspaces/{workspaceId}/modules/{moduleId}
  - moduleKey
  - /entities/{entityId} (sub-collection for module entities)
```

### 9.3 é—œéµæŸ¥è©¢æ¨¡å¼

**æŸ¥è©¢ç”¨æˆ¶å¯å­˜å–çš„æ‰€æœ‰ Workspace**:
```typescript
async function getUserWorkspaces(userId: string): Promise<Workspace[]> {
  // 1. ç”¨æˆ¶ç›´æ¥æ“æœ‰çš„ Workspace
  const ownedWorkspaces = await db.collection('workspaces')
    .where('ownerId', '==', userId)
    .where('ownerType', '==', 'user')
    .get();

  // 2. ç”¨æˆ¶æ‰€å±¬çµ„ç¹”çš„ Workspace
  const user = await db.collection('users').doc(userId).get();
  const orgWorkspaces = await db.collection('workspaces')
    .where('ownerId', 'in', user.data().organizationIds)
    .where('ownerType', '==', 'organization')
    .get();

  // 3. é€é Team å­˜å–çš„ Workspace (æŸ¥è©¢ ACL)
  const teamWorkspaces = await db.collectionGroup('permissions')
    .where('accountId', 'in', user.data().teamIds)
    .where('accountType', '==', 'team')
    .get();

  // 4. é€é Partner å­˜å–çš„ Workspace (æŸ¥è©¢ ACL)
  const partnerWorkspaces = await db.collectionGroup('permissions')
    .where('accountId', 'in', user.data().partnerIds)
    .where('accountType', '==', 'partner')
    .get();

  // åˆä½µä¸¦å»é‡
  return mergeAndDeduplicate([
    ownedWorkspaces,
    orgWorkspaces,
    teamWorkspaces,
    partnerWorkspaces
  ]);
}
```

**æŸ¥è©¢çµ„ç¹”å…§çš„æ‰€æœ‰åœ˜éšŠ**:
```typescript
async function getOrganizationTeams(orgId: string): Promise<Team[]> {
  return await db.collection('teams')
    .where('organizationId', '==', orgId)
    .get();
}
```

**æŸ¥è©¢ Workspace çš„æ‰€æœ‰å­˜å–æ¬Šé™**:
```typescript
async function getWorkspacePermissions(
  workspaceId: string
): Promise<Permission[]> {
  return await db.collection('workspaces')
    .doc(workspaceId)
    .collection('permissions')
    .get();
}
```

---

## 10. ç¸½çµ

### æ ¸å¿ƒè¨­è¨ˆè¦é»

1. **æ¸…æ™°çš„å¸³è™Ÿèˆ‡åˆ†çµ„å±¤ç´š**
   - **å¯ç™»å…¥çš„å¸³è™Ÿ**: User, Organization, Bot
   - **çµ„ç¹”å…§éƒ¨åˆ†çµ„**: Team (å¾çµ„ç¹”æˆå“¡ä¸­åˆ†çµ„)
   - **å¤–éƒ¨å”ä½œåˆ†çµ„**: Partner (å¤–éƒ¨äººå“¡,éçµ„ç¹”æˆå“¡)
   - Team å’Œ Partner ä¸æ˜¯ç¨ç«‹å¸³è™Ÿ,ä¸èƒ½ç™»å…¥æˆ–åˆ‡æ›

2. **æ˜ç¢ºçš„æ“æœ‰æ¬Šæ¨¡å‹**
   - Workspace åªèƒ½ç”± User æˆ– Organization æ“æœ‰
   - Team å’Œ Partner é€éæŒ‡æ´¾å’Œæˆæ¬Šæ©Ÿåˆ¶åƒèˆ‡å”ä½œ
   - Team ä¸èƒ½æ“æœ‰ Workspace,åªèƒ½è¢«æŒ‡æ´¾åˆ° Organization çš„ Workspace
   - Partner ä¸èƒ½æ“æœ‰ Workspace,åªèƒ½è¢«æˆæ¬Šå­˜å–ç‰¹å®šè³‡æº

3. **éˆæ´»çš„çµ„ç¹”ç®¡ç†**
   - Organization å¯å»ºç«‹å’Œç®¡ç†å…§éƒ¨ Team (å¾çµ„ç¹”æˆå“¡ä¸­é¸æ“‡)
   - Organization å¯å»ºç«‹å’Œç®¡ç†å¤–éƒ¨ Partner (é‚€è«‹å¤–éƒ¨äººå“¡)
   - Team æˆå“¡å¿…é ˆæ˜¯çµ„ç¹”æˆå“¡
   - Partner æˆå“¡æ˜¯å¤–éƒ¨äººå“¡,ä¸æ˜¯çµ„ç¹”æˆå“¡
   - æ¸…æ™°çš„æ¬Šé™å’Œå­˜å–æ§åˆ¶

4. **å®Œå–„çš„åˆ‡æ›å™¨é«”ç³»**
    - **èº«ä»½åˆ‡æ›å™¨**: 
      - ç®¡ç†å¯ç™»å…¥çš„å¸³è™Ÿ (User, Organization)
      - æ”¯æ´ç›´æ¥å‰µå»ºæ–°çµ„ç¹”
      - **å‹•æ…‹é¡¯ç¤º**: Organization èº«ä»½ä¸‹æä¾› Team / Partner ä¸Šä¸‹æ–‡åˆ‡æ›
   - **å·¥ä½œå€åˆ‡æ›å™¨**: 
     - åœ¨ç•¶å‰èº«ä»½ä¸‹åˆ‡æ› Workspace
     - æ ¹æ“šèº«ä»½é¡å‹é¡¯ç¤ºé©ç•¶çš„ Workspace åˆ†é¡
     - æ¨™è¨»å­˜å–ä¾†æº (Owner/Member/Team/Partner)
   - **æ•´åˆçš„å‰µå»ºå’Œç®¡ç†å…¥å£**:
     - é€éåˆ‡æ›å™¨å¿«é€Ÿå‰µå»ºçµ„ç¹”ã€åœ˜éšŠã€å¤¥ä¼´
     - æä¾›ä¾¿æ·çš„ç®¡ç†ä»‹é¢å…¥å£

5. **çµ±ä¸€çš„ UI/UX æ¨¡å¼**
    - Material Design 3 è¨­è¨ˆèªè¨€
    - éŸ¿æ‡‰å¼ä½ˆå±€é©é…å„ç¨®è£ç½®
    - ç„¡éšœç¤™è¨­è¨ˆç¬¦åˆ WCAG 2.1 AA æ¨™æº–
    - ä¸€è‡´çš„äº’å‹•æ¨¡å¼å’Œè¦–è¦ºå›é¥‹

### é—œéµæ¦‚å¿µå°æ¯”

| æ¦‚å¿µ | User | Organization | Team | Partner |
|------|------|-------------|------|---------|
| **æ˜¯å¦ç‚ºå¸³è™Ÿ** | âœ… æ˜¯ | âœ… æ˜¯ | âŒ å¦ | âŒ å¦ |
| **å¯å¦ç™»å…¥** | âœ… å¯ä»¥ | âœ… å¯ä»¥ | âŒ ä¸å¯ä»¥ | âŒ ä¸å¯ä»¥ |
| **å¯å¦åˆ‡æ›èº«ä»½** | âœ… å¯ä»¥ | âœ… å¯ä»¥ | âš ï¸ ä¸Šä¸‹æ–‡åˆ‡æ› | âš ï¸ ä¸Šä¸‹æ–‡åˆ‡æ› |
| **å¯å¦æ“æœ‰ Workspace** | âœ… å¯ä»¥ | âœ… å¯ä»¥ | âŒ ä¸å¯ä»¥ | âŒ ä¸å¯ä»¥ |
| **æˆå“¡é—œä¿‚** | - | åŒ…å« User | å¾ Org æˆå“¡åˆ†çµ„ | å¤–éƒ¨ User |
| **åœ¨åˆ‡æ›å™¨ä¸­** | ä¸»åˆ—è¡¨ | ä¸»åˆ—è¡¨ | Org ä¸‹çš„å­å€å¡Š | Org ä¸‹çš„å­å€å¡Š |

### æˆå“¡é—œä¿‚ç¸½çµ

```
Organization.memberIds (çµ„ç¹”æˆå“¡)
â”œâ”€ User A âœ“ å¯ä»¥åŠ å…¥ Team
â”œâ”€ User B âœ“ å¯ä»¥åŠ å…¥ Team
â””â”€ User C âœ“ å¯ä»¥åŠ å…¥ Team

Team.memberIds (åœ˜éšŠæˆå“¡,å¿…é ˆæ˜¯çµ„ç¹”æˆå“¡)
â”œâ”€ User A (å¾ Organization.memberIds é¸æ“‡)
â””â”€ User B (å¾ Organization.memberIds é¸æ“‡)

Partner.memberIds (å¤–éƒ¨å”ä½œè€…,ä¸æ˜¯çµ„ç¹”æˆå“¡)
â”œâ”€ User D âœ— ä¸åœ¨ Organization.memberIds
â””â”€ User E âœ— ä¸åœ¨ Organization.memberIds
```

### æŠ€è¡“å¯¦ä½œè¦é»

- **ç‹€æ…‹ç®¡ç†**: ä½¿ç”¨ ngrx/signals ç®¡ç†å…¨å±€ç‹€æ…‹
- **è·¯ç”±è¨­è¨ˆ**: `/workspace/:id/:module` çµæ§‹
- **è³‡æ–™åº«**: Firestore é›†åˆçµæ§‹å’ŒæŸ¥è©¢å„ªåŒ–
- **æ¬Šé™æª¢æŸ¥**: å››å±¤æ¬Šé™é«”ç³»å’Œç¹¼æ‰¿è¦å‰‡
- **æ•ˆèƒ½å„ªåŒ–**: è™›æ“¬æ»¾å‹•ã€å»¶é²è¼‰å…¥ã€æ™ºèƒ½åˆ†é 
- **TypeScript**: å®Œæ•´å‹åˆ¥å®šç¾©,é¿å…ä½¿ç”¨ç¸®å¯« (å¦‚ org)

### æ“´å±•æ€§è€ƒé‡

- **è‡ªè¨‚æ¨¡çµ„**: æ”¯æ´ç¬¬ä¸‰æ–¹æ¨¡çµ„æ“´å±•
- **API æ•´åˆ**: Bot å¸³è™Ÿç”¨æ–¼ç³»çµ±æ•´åˆ
- **å¤šç§Ÿæˆ¶**: Organization éš”é›¢,æ”¯æ´ä¼æ¥­ç´šéƒ¨ç½²
- **åˆè¦æ€§**: æ“ä½œè¨˜éŒ„éœ€æ±‚å±¬æ–¼æœªä¾†æ“´å±•,éœ€å…ˆåœ¨ Domain å®šç¾©å¾Œå†æ–°å¢æ¨¡çµ„
- **åœ‹éš›åŒ–**: æ”¯æ´å¤šèªè¨€å’Œæ™‚å€

### è¨­è¨ˆå„ªå‹¢

1. **æ¦‚å¿µæ¸…æ™°**: æ˜ç¢ºå€åˆ†å¸³è™Ÿ (Account) å’Œåˆ†çµ„ (Group)
2. **æ¶æ§‹ç°¡æ½”**: é¿å…éåº¦è¤‡é›œçš„åµŒå¥—é—œä¿‚
3. **æ“´å±•éˆæ´»**: å¯è¼•é¬†æ–°å¢æ–°çš„çµ„ç¹”çµæ§‹æˆ–å”ä½œæ¨¡å¼
4. **æ¬Šé™ç²¾æº–**: ç´°ç²’åº¦çš„å­˜å–æ§åˆ¶,æ»¿è¶³å„ç¨®å ´æ™¯
5. **ä½¿ç”¨ç›´è§€**: ä½¿ç”¨è€…å®¹æ˜“ç†è§£å’Œæ“ä½œ

---

**æ­¤è¨­è¨ˆè¦æ ¼å¯ç›´æ¥ç”¨æ–¼ç³»çµ±é–‹ç™¼,æ¶µè“‹æ¦‚å¿µã€æ¶æ§‹ã€UI/UXã€è³‡æ–™æ¨¡å‹çš„å®Œæ•´å®šç¾©ã€‚**
